
<!-- saved from url=(0041)http://www.win.tue.nl/hashclash/rogue-ca/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>MD5 considered harmful today</title>
<style type="text/css">
<!--
body {font-family: Arial; background-image: url(images/visprint2.gif);}
a:link {color: #FF0000;}
a:visited {color: #800000;}
code {font-family: Courier New; font-size: medium;}
ul {margin-left: 20px; padding-left: 0px;}
-->
</style>
</head>

<body>

<table>
<tbody><tr valign="top"><td width="200" align="right" valign="bottom">
        <p><b>December 30, 2008</b></p><b>
        </b><p><b>&nbsp;</b></p>
    </td>
    <td width="10">
    <td width="800">
        <h1>MD5 considered harmful today</h1>
        <h2>Creating a rogue CA certificate</h2>
        <h3>Alexander Sotirov, Marc Stevens, <br> Jacob Appelbaum, Arjen Lenstra, David Molnar, Dag Arne Osvik, Benne de Weger</h3>
    </td></tr>
<tr><td><hr></td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right"><b>
        Latest news
    </b></td><td><td width="800">
        [Dec. 31, 2008] <a href="http://www.win.tue.nl/hashclash/rogue-ca/#sec71">Responses from Verisign (RapidSSL), Microsoft and Mozilla</a>.<br>
        [Jan. 2, 2009] <a href="http://www.win.tue.nl/hashclash/rogue-ca/#sec71">Responses from TC TrustCenter and RSA, and a US-CERT Vulnerability Note</a>.<br>
        [Jan. 8, 2009] <a href="http://www.win.tue.nl/hashclash/rogue-ca/#secPres">Video and audio files of the 25C3 presentation</a> are available from CCC.<br>
        [Jan. 15, 2009] <a href="http://www.win.tue.nl/hashclash/rogue-ca/#sec71">Response from Cisco</a>.<br>
        [Mar. 11, 2009] Our <a href="http://eprint.iacr.org/2009/111" target="_blank">paper with details on improved MD5 chosen-prefix collision construction</a> is available.<br>
        [Apr. 30, 2009] Our paper is accepted at <a href="http://www.iacr.org/conferences/crypto2009/" target="_blank">Crypto 2009</a>.<br>
        [June 2, 2009] A new <a href="http://www.win.tue.nl/hashclash/SingleBlock/" target="_blank">single block chosen-prefix collision</a>.<br>
        [June 3, 2009] Our Crypto 2009 paper has won the best paper award.<br>
        [June 16, 2009] Full paper now available:
        <a href="https://documents.epfl.ch/users/l/le/lenstra/public/papers/lat.pdf" target="_blank">Marc Stevens,
        Arjen Lenstra and Benne de Weger, "Chosen-prefix Collisions for MD5 and Applications"</a>,
        submitted to the <a href="http://www.iacr.org/jofc/jofc.html">Journal of Cryptology</a>.<br>
        [August 22, 2009] The <a href="http://deweger.xs4all.nl/papers/[41]StSoApLeMoOsdW-RogueCA-Crypto[2009].pdf" target="_blank">Crypto paper</a> and the
        <a href="http://www.win.tue.nl/~bdeweger/award.html" target="_blank">best paper award</a>.<br>
        [January 12, 2010] Our work made it to number 1 of the
        <a href="http://jeremiahgrossman.blogspot.com/2010/01/top-ten-web-hacking-techniques-of-2009.html" target="_blank">Top Ten Web Hacking Techniques of 2009</a>.
    </td></tr>
<tr><td><hr></td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right"><b>
        Summary
    </b></td><td><td width="800">
    <p>We have identified a vulnerability in the Internet Public Key Infrastructure (PKI) used to
    issue digital certificates for secure websites. As a proof of concept we executed a practical
    attack scenario and successfully created a rogue Certification Authority (CA) certificate trusted
    by all common web browsers. This certificate allows us to impersonate any website on the
    Internet, including banking and e-commerce sites secured using the HTTPS protocol.</p>

    <p>Our attack takes advantage of a weakness in the MD5 cryptographic hash function that allows
    the construction of different messages with the same MD5 hash. This is known as an MD5 "collision".
    Previous work on MD5 collisions between 2004 and 2007 showed that the use of this hash function
    in digital signatures can lead to theoretical attack scenarios. Our current work proves that at
    least one attack scenario can be exploited in practice, thus exposing the security
    infrastructure of the web to realistic threats.</p>

    <p>As a result of this successfull attack, we are currently in possession of a rogue Certification
    Authority certificate. This certificate will be accepted as valid and trusted by all common
    browsers, because it appears to be signed by one of the root CAs that browsers trust by default. In
    turn, any website certificate signed by our rogue CA will be trusted as well. If an unsuspecting
    user is a victim of a man-in-the-middle attack using such a certificate,
    <img src="./MD5 considered harmful today_files/certok.png" style="float: right; margin: 10px 5px;">
    they will be assured that the connection is secure through all common security indicators:
    <img src="./MD5 considered harmful today_files/padlock.png" style="float: left; margin: 5px 10px;">
    a "https://" url in the address bar, a closed padlock and messages such as
    "This certificate is OK" if they chose to inspect the certificate.</p>

    <p>This successful proof of concept shows that the certificate validation performed by browsers
    can be subverted and malicious attackers might be able to monitor or tamper with data sent to
    secure websites. Banking and e-commerce sites are particularly at risk because of the high value
    of the information secured with HTTPS on those sites. With a rogue CA certificate, attackers
    would be able to execute practically undetectable phishing attacks against such sites.</p>

    <p>The infrastructure of Certification Authorities is meant to prevent exactly this type of
    attack. Our work shows that known weaknesses in the MD5 hash function can be exploited in
    realistic attack, due to the fact that even after years of warnings about the lack of security of MD5,
    some root CAs are still using this broken hash function.</p>

    <p>The vulnerability we expose is not in the SSL protocol or the web servers and browsers that
    implement it, but in the Public Key Infrastructure. This infrastructure has applications in
    other areas than the web, but we have not investigated all other possible attack scenarios. So
    other attack scenarios beyond the web are conceivable, such as in the areas of code
    signing, e-mail security, and in other areas that use certificates for enabling digital
    signatures or public key encryption.</p>

    <p>The rest of this document will explain our work and its implications in a fair amount of
    detail. In the interest of protecting the Internet against malicious attacks using our
    technique, we have omitted the critical details of our sophisticated and highly optimized method
    for computing MD5 collisions. A scientific paper <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[SSALMOW]</a> about our method is
    available as of March 11, 2009, so that the affected
    Certification Authorities have had some time
    to remedy this vulnerability.</p>
    </td></tr>
<tr><td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        Organization
    </td><td><td width="800">
        <p></p><ul>
        <li> <a href="http://www.win.tue.nl/hashclash/rogue-ca/#sec1">Section 1</a> below gives an outline of our work.
        </li><li> To fully appreciate our result some basic knowledge is required. Therefore in <a href="http://www.win.tue.nl/hashclash/rogue-ca/#sec2">section 2</a> we
             provide some background on certificates, and in <a href="http://www.win.tue.nl/hashclash/rogue-ca/#sec3">section 3</a> we describe the necessary
             details on hash functions. Readers familiar with those topics may want to skip (large
             parts of) these sections.
        </li><li> Our present work can be seen as a continuation of recent
             work in the last few years, of which the history is briefly sketched in <a href="http://www.win.tue.nl/hashclash/rogue-ca/#sec4">section 4</a>.
        </li><li> <a href="http://www.win.tue.nl/hashclash/rogue-ca/#sec5">Section 5</a> describes our method in detail. Readers not interested in many
             technical topics may want to skip (large parts of) this section.
        </li><li> The possible impact of the attack scenarios and possible countermeasures are dealt with in
             <a href="http://www.win.tue.nl/hashclash/rogue-ca/#sec6">section 6</a> and <a href="http://www.win.tue.nl/hashclash/rogue-ca/#sec7">section 7</a> respectively.
        </li><li> We conclude with "Frequently asked questions" in <a href="http://www.win.tue.nl/hashclash/rogue-ca/#sec8">section 8</a>.
        </li></ul><p></p>
    </td></tr>
<tr><td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        <a name="secPres">Presentation</a>
    </td><td><td width="800">
        <p>This work was presented on December 30, 2008 at the <a href="http://events.ccc.de/congress/2008/" target="_blank">25th Annual
        Chaos Communication Congress</a> in Berlin.</p>

        <p><img src="./MD5 considered harmful today_files/25c3.png" border="0"></p>

        <p>The presentation was originally announced as "Making the theoretical possible.
        Attacking a critical piece of Internet infrastructure",
        but finally was entitled
        <a href="http://www.win.tue.nl/hashclash/rogue-ca/downloads/md5-collisions-1.0.pdf" target="_blank">"MD5 considered harmful today: creating a rogue CA certificate"</a>.</p>

        <p>[added Jan. 8, 2009] <a href="http://events.ccc.de/congress/2008/wiki/Conference_Recordings" target="_blank">Video
        and audio files of the 25C3 presentation</a> in different formats are available from CCC. Look for files with names like
        "25c3-3023-en-making_the_theoretical_possible.xyz".</p>

        <p>Our demo at the 25c3 was based on
        <a href="http://thoughtcrime.org/software/sslsniff/index.html" tagret="_blank">"sslsniff"</a>
        by Moxie Marlinspike. We modified it ever so slightly to be more verbose
        (and hopefully more visual as a demo), to randomize serial numbers (to
        fix an issue with Firefox) and to sign with a user selected hash function
        (this allowed for SHA-1 signatures in the leaf certificate). Jacob
        Appelbaum misspoke when he said that he had written this tool at the
        start; he correctly explained the tool's origin at the end of the video.</p>
    </td></tr>
<tr><td><hr></td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right"><b>
        <a name="sec1">1. Outline of the attack</a>
    </b></td><td><td width="800">
        <p>Our attack scenario basically is as follows. We request a legitimate website certificate
        from a commercial Certification Authority trusted by all common browsers. Since the request is
        legitimate, the CA signs our certificate and returns it to us. We have picked a CA that
        uses the MD5 hash function to generate the signature of the certificate, which is
        important because our certificate request has been crafted to result in an MD5 collision
        with a second certificate. This second certificate
        is not a website certificate, but an intermediary CA certificate that can be used to sign
        arbitrary other website certificates we want to issue. Since the MD5 hashes of both the
        legitimate and the rogue certificates are the same, the digital signature obtained from the
        commercial CA can simply be copied into our rogue CA certificate and it will remain valid.</p>

        <p>
        <table><tbody><tr><td valign="top">
        Here is a schematic diagram and a description of how website certificates are meant to operate.
        <table width="100%">
        <tbody><tr><td valign="top"><div style="border: 1px solid black; padding: 2px;">1</div></td><td>
             A Certification Authority distributes its CA root certificate (the white one in the diagram)
             via browser vendors to browsers. These root certificates reside in a "trust list" on the user's PC.
             This means that all certificates issued by this CA will be trusted by default by
             the users.</td></tr>
        <tr><td valign="top"><div style="border: 1px solid black; padding: 2px;">2</div></td><td>
             A company that wants its website to be secured, purchases a website certificate
             at the CA (the green one in the diagram). This certificate is signed by the CA and guarantees the identity
             of the website to the users.</td></tr>
        <tr><td valign="top"><div style="border: 1px solid black; padding: 2px;">3</div></td><td>
             When a user wants to visit the secure website, the web browser will first ask
             the web server for the certificate. If its signature can be verified with the
             certificate of a CA in the trust list, the website certificate will be accepted.
             Then the website will be loaded into the browser, and all traffic between the browser
             and the website will be secured by using encryption.</td></tr>
        </tbody></table>
        </td><td>
        <img src="./MD5 considered harmful today_files/normal.png" style="margin: 10px 5px;">
        </td></tr></tbody></table></p>

        <p>And here is a similar diagram and description of how our attack scenario may be used
        to impersonate an existing website.</p>

        <p><img src="./MD5 considered harmful today_files/attack.png" style="margin: 5px 10px;"></p>

        <p>
        <table width="100%">
        <tbody><tr><td valign="top"><div style="border: 1px solid black; padding: 2px;">1a</div></td><td>
             A legitimate website certificate is obtained from a commercial CA (the blue one in the diagram). </td></tr>
        <tr><td valign="top"><div style="border: 1px solid black; padding: 2px;">1b</div></td><td>
             A rogue CA certificate is constructed (the black one in the diagram).
             It bears exactly the same signature as the website certificate. Thus it appears
             as being issued by the CA, whereas in fact the CA has never even seen it.</td></tr>
        <tr><td valign="top"><div style="border: 1px solid black; padding: 2px;">2</div></td><td>
             Then a website certificate (the red one in the diagram) bearing the genuine website's
             identity but another public key is created and signed
             by the rogue CA. A copy of the genuine website is built, put on another web server,
             and equipped with the rogue website certificate.</td></tr>
        <tr><td valign="top"><div style="border: 1px solid black; padding: 2px;">3</div></td><td>
             When a user wants to visit the secure website, the web browser will look on the
             Internet for the genuine web server. There exist "redirection attacks",
             by which the communication from the browser can be redirected to the rogue website.
             This rogue website presents its certificate to the user,
             together with the rogue CA certificate. The signature in the rogue website certificate
             can be verified with the rogue CA certificate, and this rogue CA
             certificate in turn will be accepted by the browser, as its signature can be verified
             with the CA root certificate in the trust list. The user will not notice anything.</td></tr>
        </tbody></table></p>

        <p>An effective and efficient countermeasure to remediate this vulnerability is to
        stop using MD5 for digital signatures. Acceptable alternatives to replace MD5,
        such as SHA-1, are widespread or, like SHA-2, at least becoming rapidly available. Fortunately
        most CAs have already taken such steps. It would be best to stop using MD5 for
        the creation of certificates altogether, as its continued use may lead to severe
        security problems. As a last resort, in the case that MD5 cannot be discontinued
        immediately, a CA can take simple alternative countermeasures such as
        randomizing the serial numbers of all newly issued certificates. We
        stress that such countermeasures are mere band-aids rather than
        fundamental solutions.</p>

        <p>We also recommend to be similarly careful when using SHA-1 and to avoid its
        adoption in new products, as theoretically it has been shown that it suffers
        from similar problems as MD5. While the weaknesses in SHA-1 known so far do at
        this moment not allow the same type of attack scenarios we have shown to be possible for MD5, experts in
        the area believe that it is sufficiently likely that before long SHA-1 suffers
        the same fate as MD5.</p>
    </td></tr>
<tr><td><hr></td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right"><b>
        <a name="sec2">2. Certificate background</a>
    </b></td><td><td width="800">
    </td></tr>
<tr><td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        2.1. The need for certificates
    </td><td><td width="800">
        <p>More and more the web is used for exchanging sensitive information. Think of
        internet banking websites, websites that require a login password, websites on
        which transactions with financial value can be performed, etc. Often the
        sensitivity of the information implies that it should not be exposed to
        unauthorized persons.
        The exchange of sensitive information requires that the user of a
        website wants assurance that the website he or she is visiting is not a rogue web
        site, but is the genuine website of the organisation he or she has to do business
        with. This is what certificates provide.</p>

        <p><img src="./MD5 considered harmful today_files/cert-groen.png" style="float: right; margin: 10px 5px;">
        A certificate is a document that contains both an identity and a public key,
        binding them together by a digital signature.
        This digital signature is created by an organisation called a Certification
        Authority (CA). This organisation guarantees that upon creating the digital
        signature it has checked the identity of the public key owner (e.g. by verifying
        a passport) and that is has checked that this public key owner is in possession
        of the corresponding private key. Anybody in possession of the CA's public key
        can verify the CA's signature on the certificate. In this way the CA guarantees
        that the public key in the certificate belongs to the individual whose identity
        is in the same certificate.</p>
    </td></tr>
<tr><td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        2.2. X.509 certificates
    </td><td><td width="800">
        <p>The worldwide accepted standard for digital certificates is called X.509. An X.509
        certificate contains the following parts
        </p><ul>
        <li> the "to-be-signed" part, consisting of:
          <ul>
          <li> serial number
          </li><li> validity period
          </li><li> issuer name - this is the identity of the issuing CA
          </li><li> subject name - this is the identity of the party being certified; this can
            be a user (person, organisation, website), another CA, or even the issuing CA itself
          </li><li> subject public key - the public key of the party being certified
          </li><li> "basic constraints" field, containing
            <ul>
            <li> a bit indicating whether this is a CA certificate or a user certificate
              (we will denote this by "CA = TRUE" resp. "CA = FALSE")
            </li><li> a path length field, indicating the maximum number of intermediate CAs
              that are allowed between the "root CA" and the end user
            </li></ul>
          </li></ul>
        </li><li> the "signature" part, containing a digital signature over the "to-be-signed"
          part; this digital signature is produced using the issuing CA's private key.
        </li></ul>
        By the digital signature in a certificate, the CA guarantees that it has checked
        (according to its policies) that the subject identity mentioned inside the certificate
        is indeed the owner of the public key that is inside the same
        certificate, and that this public key owner also is in possession of the
        corresponding private key. The signature in the certificate can be verified by
        anybody, by using the issuing CA's public key.<p></p>
    </td></tr>
<tr><td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        2.3. Certificate hierarchy
    </td><td><td width="800">
        <img src="./MD5 considered harmful today_files/X509TrustModel.png" style="float: right; margin: 10px 5px;">
        <p>X.509 certificates fit into a hierarchy of CA and end user certificates. A
        signature on data can be verified by the signer's public key. This public
        key is linked to the owner's identity by a certificate. This link can be
        verified by verifying the certificate's signature, using the public key of the
        issuing CA. This CA public key can be found inside the CA certificate, one layer
        upwards in the hierarchy. This CA certificate will itself be signed by a CA
        another layer up. At the top of the hierarchy there is the "root certificate",
        that is "self signed", and that has to be trusted for its own sake.</p>

        <p>Many of these self signed root certificates are installed in browsers or
        operating systems. Applications using them, such as web browsers, will trust
        them automatically, i.e. the applications will accept the certificates as
        authenticated and genuine without explicitly asking the user if it should do so.
        The user may be notified by small security signs such as a closed padlock symbol
        in the browser's frame. Every certificate that is in a hierarchy of which the
        root certificate is trusted, is also automatically trusted.</p>
    </td></tr>
<tr><td><hr></td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right"><b>
        <a name="sec3">3. Hash function background</a>
    </b></td></tr>
<tr><td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        3.1. Hash functions
    </td><td><td width="800">
        <p>The cryptographic operation that uses a private key to sign data
        does not deal directly with the data itself, but with a purportedly
        unique representation of this data, that has a predetermined fixed length, is
        short and therefore convenient to work with. This can be compared to a
        fingerprint as a purportedly unique, short and convenient representation of a
        human being. The process of creating such short representations of data is
        called "hashing". Unfortunately, because of the fixed length of the hash, there must
        exist pairs of different inputs that yield the same hash value. Good
        hash functions, however, have the property that finding such pairs is
        extremely difficult, even though they are guaranteed to exist. This is
        precisely where MD5 has a crucial weakness.</p>

        <p>A "hash function" is a cryptographic function that takes as its input a
        bit string of any length, performs a deterministic algorithm with this input,
        and produces as output a bit string of fixed length. This output is called the
        "hash value" or the "hash" of the input. Other terms that can be found for "hash
        value" are "fingerprint" or "message digest"</p>

        <p>If <code>H</code> is a hash function, <code>m</code> is an input bit string, and
        <code>h</code> is the output of <code>H</code> applied to the input <code>m</code>, then we write <code>h = H(m)</code>. Some common
        and useful terminology:
        </p><ul>
        <li>if <code>h = H(m)</code> then
          <ul>
          <li> <code>h</code> is called the "hash" of <code>m</code>,
          </li><li> <code>m</code> is called a "preimage" of <code>h</code>,
          </li></ul>
        </li><li> for a given input <code>m</code>, a "second preimage" of <code>m</code> is a different input <code>m'</code> such that
          <code>H(m) = H(m')</code>,
        </li><li> if <code>m</code> and <code>m'</code> are different inputs such that <code>H(m) = H(m')</code> then the pair <code>{m,m'}</code>
          is called a "collision" for <code>H</code>.
        </li></ul>
        The difference between the concepts of second preimage and collision is subtle,
        but crucial.<p></p>
    </td></tr>
<tr><td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        3.2. Hash function requirements
    </td><td><td width="800">
        <p>A hash function should satisfy the following requirements:
        </p><ul>
        <li> (<b>practicality</b>) computing the hash <code>h(m)</code> of any input <code>m</code> can be done efficiently,
        </li><li> (<b>preimage resistance</b>) given <code>h</code>, it is hard to compute a preimage of <code>h</code>, i.e. it
          is hard to compute an <code>m</code> such that <code>h = H(m)</code>,
        </li><li> (<b>second preimage resistance</b>) given <code>m</code>, it is hard to compute a second preimage
          of <code>m</code>, i.e. it is hard to compute an <code>m'</code> such that <code>m &#8800; m'</code> and yet <code>H(m) = H(m')</code>,
        </li><li> (<b>collision resistance</b>) it is hard to compute a collision for <code>H</code>, i.e. it is
          hard to compute <code>m</code> and <code>m'</code> such that <code>m &#8800; m'</code> and yet <code>H(m) = H(m')</code>.
        </li></ul>
        Let us assume that we have a hash function which produces hashes with a length
        of <code>k</code> bits. Brute force methods simply try all possible inputs in a
        certain range, or try a large number of random inputs, until a (second) preimage
        or a collision are found. For (second) preimage resistance
        this requires an expected number of hash computations equal to <code>2<sup>k</sup></code>. For collision
        resistance the situation is different, due to the "birthday paradox", reducing the number of hash computations to approximately
        <code>2<sup>k/2</sup></code>. Cryptographers say that a hash function with hash
        length <code>k</code> provides only <code>k/2</code> bits security.<p></p>

        <p>A cryptographic hash function is said to be "cryptographically strong" if no
        better methods are known than the above mentioned brute force type methods
        with the mentioned complexities.</p>
    </td></tr>
<tr><td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        3.3. Hash function history
    </td><td><td width="800">
        <p>In 1990 Rivest designed MD4, a hash function with hash length 128 bits.
        Collisions for MD4 were found in 1995. In 2005 a method for finding preimages was published.</p>

        <p>In 1991 Rivest announced MD4's successor, MD5, an improved design, also with
        hash length 128. In 1993 some weaknesses in its design were pointed out, but it
        took until 2004 before collisions were found. Producing collisions is nowadays
        a matter of seconds on a PC. The more advanced type of collisions used in our
        method can be produced in a matter of hours on special but commodity hardware.</p>

        <p>In 1995 NIST proposed SHA-1, a hash function with hash length 160 bits. In 2005
        weaknesses in its design were found, showing that finding collisions takes
        essentially fewer computations than the brute force method of complexity 2<sup>80</sup>,
        but so far collisions have not been published. NIST advises to replace SHA-1 by
        2010.</p>

        <p>From their introduction until the present day, the hash functions MD5 and SHA-1 have been the work horses
        of many cryptographic systems. The replacement of MD5 in
        common applications is far from completed. The replacement of SHA-1 has not really taken off yet.</p>

        <p>Even if SHA-1 would have lived up to its design objectives, its output
        length of 160 is too small to justify its prolonged use for more than the short
        term. NIST recognized this at an early stage, and came in 2001 with the new
        SHA-2 family of hash functions. So far these have withstood all
        cryptanalysis. Nevertheless NIST saw the need for mobilizing the cryptographic
        community to get a deeper understanding of hash function design and to come up
        with better hash functions for the next 10 years. Therefore it has started an
        open competition for selecting the successor of SHA-2, dubbed for the moment
        SHA-3. The winner of this competition is expected to be selected by 2012, and
        will most probably become the de facto hashing standard for the next decade.</p>
    </td></tr>
<tr><td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        3.4. The Design of MD5
    </td><td><td width="800">
        <p>MD5 uses the Merkle-Damgård iterative construction. The input bit string is
        padded to a multiple of 512 bits. The length of the unpadded bit string is
        incorporated in this padding. Then the padded input bit string is divided into
        blocks of 512 bits each, hereafter called "input blocks".</p>

        <p><img src="./MD5 considered harmful today_files/MD5.png" style="float: right; margin: 10px 5px;">
        The core of MD5 is a compression function. The input blocks are fed to MD5 in
        successive calls to the compression function, that uses each input block in
        updating a state of 128 bits. This state is called <code>IHV</code>, which stands for
        "Intermediate Hash Value". Thus the compression function accepts as input a
        128 bit state <code>IHV</code> and a 512 bit data block, and produces as output an updated
        state <code>IHV</code>. The initial state is a fixed value, and the final state is the hash
        value.</p>

        <p>So if we denote the input blocks by <code>M<sub>1</sub>, M<sub>2</sub>, ..., M<sub>n</sub></code> (512 bits each), the
        initial <code>IHV</code> by <code>IHV<sub>0</sub></code> (128 bits), and the compression function by <code>CF</code>, then
        the sequence of computations is</p>

        <p><code>
        IHV<sub>0</sub> = fixed value<br>
        IHV<sub>1</sub> = CF(IHV<sub>0</sub>, M<sub>1</sub>)<br>
        IHV<sub>2</sub> = CF(IHV<sub>1</sub>, M<sub>2</sub>)<br>
        IHV<sub>3</sub> = CF(IHV<sub>2</sub>, M<sub>3</sub>)<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:<br>
        IHV<sub>n-1</sub> = CF(IHV<sub>n-2</sub>, M<sub>n-1</sub>)<br>
        IHV<sub>n</sub> = CF(IHV<sub>n-1</sub>, M<sub>n</sub>)<br>
        MD5 hash = IHV<sub>n</sub>
        </code></p>
    </td></tr>
<tr><td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        3.5. Collisions for MD5
    </td><td><td width="800">
        <p>In 2004 Xiaoyun Wang and Hongbo Yu presented a collision for MD5 consisting of 2
        input blocks, neglecting padding. Details of the collision construction method were published at
        EuroCrypt 2005 in <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[WY]</a>. Their method works for any value of the initial <code>IHV<sub>0</sub></code>.</p>

        <p>In other words, their method produces on input of any 128 bit <code>IHV<sub>0</sub></code> a pair
        <code>{{M<sub>1</sub>,M<sub>2</sub>}, {M<sub>1</sub>',M<sub>2</sub>'}}</code>,
        each consisting of two 512 bit input blocks, such that
        <code>{M<sub>1</sub>,M<sub>2</sub>} &#8800; {M<sub>1</sub>',M<sub>2</sub>'}</code>, and</p>

        <p><code>
        IHV<sub>0</sub>                  = IHV<sub>0</sub>'
        <br>
        IHV<sub>1</sub> = CF(IHV<sub>0</sub>,M<sub>1</sub>) &#8800; IHV<sub>1</sub>' = CF(IHV<sub>0</sub>',M<sub>1</sub>')
        <br>
        IHV<sub>2</sub> = CF(IHV<sub>1</sub>,M<sub>2</sub>) = IHV<sub>2</sub>' = CF(IHV<sub>1</sub>',M<sub>2</sub>')
        </code></p>

        <p><img src="./MD5 considered harmful today_files/identIV.png" style="float: left; margin: 5px 10px;">
        Due to the iterative structure of MD5 and to the fact that <code>IHV<sub>0</sub></code> can have any
        128 bit value, such collisions can be combined into larger inputs. Namely, for any
        given prefix <code>P</code> and any given suffix <code>S</code> a pair of "collision blocks" <code>{C,C'}</code> can be
        computed such that <code>MD5(P||C||S) = MD5(P||C'||S)</code>. We use the term "collision
        block" for a specially crafted bit string that is inserted into another
        bit string to achieve a collision. One collision block may consist of several
        input blocks, even including partial input blocks. The collision blocks of <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[WY]</a>
        consist of precisely two consecutive input blocks.</p>
    </td></tr>
<tr><td><td>&nbsp;</td><td></tr>
<tr valign="top"><td width="200" align="right">
    </td><td><td width="800">
        <p>In his 2007 MSc thesis <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[S]</a> (see also <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[SLW]</a>), Marc Stevens extended this collision construction method
        to so called "chosen-prefix collisions". This means that collisions can be found
        between different arbitrary initial <code>IHV</code>s. His method may require more than two
        input blocks.</p>

        <p><img src="./MD5 considered harmful today_files/diffIV.png" style="float: right; margin: 10px 5px;">
        Thus, due to the iterative structure of MD5, the chosen-prefix collision construction method
        is able to produce on input of any pair of chosen prefixes <code>{P,P'}</code> and any suffix
        <code>S</code>, a pair of collision blocks <code>{C,C'}</code>, such that <code>MD5(P||C||S) = MD5(P'||C'||S)</code>.</p>

        <p>To be more precise, for given <code>{P,P'}</code> the collision blocks are constructed as
        follows. First <code>P, P'</code> are padded with bit strings <code>A, A'</code> of any useful size and
        contents to achieve equal lengths of <code>P||A</code> and <code>P'||A'</code>. Then, using a
        "birthdaying" step, bit strings <code>B, B'</code> are produced such that the resulting
        <code>P||A||B</code> and <code>P'||A'||B'</code> have equal length, being a multiple of 512, and such
        that the resulting <code>IHV</code>s at this point have a prespecified structure. This enables the
        construction of a
        pair of "near collision blocks" <code>{NC,NC'}</code> that gives rise to a collision.
        Each near collision block will consist of a number of 512 bit input blocks.
        Thus, with <code>C = A||B||NC</code> and
        <code>C' = A'||B'||NC'</code>, the resulting <code>IHV</code>s are identical.
        Consequently, <code>MD5(P||C) = MD5(P'||C')</code>, and thus also for any suffix <code>S</code> it is the case
        that <code>MD5(P||C||S) = MD5(P'||C'||S)</code>.</p>

        <p>The chosen-prefix collision construction method is feasible in practice, but of essentially
        higher complexity than the method using identical arbitrary initial <code>IHV</code>s.
        However, in return one gets complete freedom in the choice of both prefixes <code>P</code> and <code>P'</code>.</p>
    </td></tr>
<tr><td><hr></td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right"><b>
        <a name="sec4">4. Colliding certificates history</a>
    </b></td><td><td width="800">
    </td></tr>
<tr><td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        4.1. Meaningfulness
    </td><td><td width="800">
        <p>The main problem in trying to abuse the type of collisions for MD5 that can be
        produced with the available methods is that one does not have sufficient control
        over the input blocks that are calculated to let the <code>IHV</code>s collide. This means
        that no methods are known to obtain collision blocks with a prescribed
        formatting, which would be needed to make the collision blocks fit into a
        meaningful file.</p>

        <p>For a number of different file types, applications of collisions and chosen-prefix
        collisions have been described in the literature solving the problem of
        meaningfulness in various ways, see e.g.
        <a href="http://th.informatik.uni-mannheim.de/People/lucks/HashCollisions/" target="_blank">"The story
        of Alice and her Boss"</a>.
        We now concentrate on the applications to certificates.</p>
    </td></tr>
<tr><td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        4.2. Different public keys
    </td><td><td width="800">
        <p>In 2005 Arjen Lenstra, Benne de Weger and Xiaoyun Wang <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[LW]</a> showed how
        collisions of the identical initial <code>IHV</code> type could be built into a pair of X.509
        certificates. For an example, see
        <a href="http://www.win.tue.nl/~bdeweger/CollidingCertificates/" target="_blank">"Colliding
        X.509 Certificates based on MD5-collisions"</a>.
        The main idea was to hide the random-looking (but carefully
        engineered) collision blocks in the public key. This will not raise any
        suspicion, not even to a careful observer who scrutinizes all bits of a
        certificate looking for signs of fraud, as public keys usually look perfectly
        like random data anyway. It turned out to be possible to hide collision blocks
        inside RSA moduli while even assuring the security of the pairs of moduli as
        being both products of sufficiently large primes. Thus it was shown how to
        produce a pair of different X.509 certificates with identical MD5 hash values of
        the "to-be-signed" parts, and therefore with identical CA signatures. This is a
        violation of fundamental principles of the certificate infrastructure. However, as the prefixes of the
        colliding inputs had to be equal, the certificates were showing identical
        identities, severely limiting the practical abuse potential.</p>
    </td></tr>
<tr><td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        4.3. Different identities
    </td><td><td width="800">
        <p>In 2007, due to the work of Marc Stevens <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[S]</a>, chosen-prefix collisions for
        MD5 had become available. This meant that it had
        become possible to choose any pair of prefixes in the certificates before the
        RSA moduli, and get certificates with different chosen identities and different
        public keys (hiding the collision blocks), and with identical MD5 hash values of
        the "to-be-signed" parts, thus with identical CA signatures. For an example, see
        <a href="http://www.win.tue.nl/hashclash/TargetCollidingCertificates/" target="_blank">"Colliding X.509
             Certificates for Different Identities"</a>. This is already a
        much more interesting application. However, a number of limitations complicate this
        attack when applied to real Certification Authorities.</p>

        <p>The attacker has to choose the entire prefix before the collision generation process can
        begin. This includes fields that the attacker does not directly control, such as the
        validity period and serial number of the signed certificate.  Succesfully predicting those
        fields requires significant control over the CA's operational procedures, which was thought to be
        hard to achieve. In addition, the colliding certificates in
        <a href="http://www.win.tue.nl/hashclash/TargetCollidingCertificates/" target="_blank">"Colliding X.509
             Certificates for Different Identities"</a> used 8192
        bit RSA keys, which are not accepted by all Certification Authorities.</p>

        <p>Nevertheless, both the collision construction method of 2005 and the much better
        chosen-prefix collision construction method of 2007 on
        certificates based on MD5 were a firm warning to the security community that MD5
        should no longer be used for digital signatures in certificates.
        As attacks only get better with time, it should not come as a surprise that in 2008 we were able
        to improve upon the previous work on colliding certificates and obtain a rogue CA certificate
        signed by a commercial Certification Authority.</p>
    </td></tr>
<tr><td><hr></td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right"><b>
        <a name="sec5">5. Attack details</a>
    </b></td><td><td width="800">
    </td></tr>
<tr><td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        5.1. Introduction
    </td><td><td width="800">
        <p>In July 2008 we set out to investigate if the colliding certificates attack could be
        applied to a real Certification Authority. The first step was to identify the CAs that still used MD5.
        Unfortunately it is not possible to determine the hash function a CA uses from the CA certificate.
        We had to look at (website) certificates issued by the CAs instead. Over the
        course of a week we spidered the web and collected more than 100,000 SSL certificates, of
        which about 30,000 were signed by CAs trusted by Firefox. There were six CAs that had issued
        certificates signed with MD5 in 2008:</p>

        <p></p><ul>
            <li><a href="http://www.rapidssl.com/" target="_blank">RapidSSL</a><br>
            C=US, O=Equifax Secure Inc., CN=Equifax Secure Global eBusiness CA-1</li>
            <li><a href="http://www.rapidssl.com/ssl-certificate-products/free-ssl/freessl.htm" target="_blank">FreeSSL</a>
            (free trial certificates offered by RapidSSL)<br>
            C=US, ST=UT, L=Salt Lake City, O=The USERTRUST Network, OU=http://www.usertrust.com,
            CN=UTN-USERFirst-Network Applications</li>
            <li><a href="http://www.trustcenter.de/" target="_blank">TC TrustCenter AG</a><br>
            C=DE, ST=Hamburg, L=Hamburg, O=TC TrustCenter for Security in Data Networks GmbH,
            OU=TC TrustCenter Class 3 CA/emailAddress=certificate@trustcenter.de</li>
            <li><a href="https://www.verisign.com/repository/root.html#rsass" target="_blank">RSA Data Security</a><br>
            C=US, O=RSA Data Security, Inc., OU=Secure Server Certification Authority</li>
            <li><a href="http://www.thawte.com/" target="_blank">Thawte</a><br>
            C=ZA, ST=Western Cape, L=Cape Town, O=Thawte Consulting cc, OU=Certification Services
            Division, CN=Thawte Premium Server CA/emailAddress=premium-server@thawte.com</li>
            <li><a href="http://www.verisign.co.jp/" target="_blank">verisign.co.jp</a><br>
            O=VeriSign Trust Network, OU=VeriSign, Inc., OU=VeriSign International Server CA - Class
            3, OU=www.verisign.com/CPS Incorp.by Ref. LIABILITY LTD.(c)97 VeriSign
            </li>
        </ul><p></p>

        <p>Out of the 30,000 certificates we collected, about 9,000 were signed using MD5, and 97% of those
        were issued by RapidSSL.</p>

        <p>It was quite surprising that so many CAs are still using MD5, considering that MD5 has
        been known to be insecure since the first collisions were presented in 2004. Since these CAs
        had ignored all previous warnings by the cryptographic community, we felt that it would be
        appropriate to attempt a practical attack to demonstrate the risk they present to everybody
        using a web browser that includes their root CA certificates.</p>

        <p>We set out to obtain a legitimate website certificate from this CA
        for which we would be able to predict the entire contents of the "to-be-signed" part.
        This certificate would contain a specially crafted collision block in the RSA modulus,
        which would result in a MD5 collision with a second specially crafted certificate. An
        ignorant observer, no matter how carefully the certificate is inspected, would most
        likeley fail to notice anything suspicious about it.</p>

        <p>Once we have obtained a valid signature from this CA, we would copy it into our second
        certificate. Since the "to-be-signed" parts of both certificates have the same MD5 hash, the
        signature would be valid for the second certificate. Thus the real CA, without knowing it,
        would provide us with a valid signature for a certificate it has never seen, and
        should never have signed.</p>

        <p>The potential of this attack scenario is even greater than just obtaining a
        rogue certificate for a single secure website. This is because
        our rogue certificate doesn't have to be a website certificate, but it could be an
        intermediary
        CA certificate. Although the certificate originally signed by the real CA has in the "basic
        constraints" field the flag "CA = FALSE", indicating that this certificate cannot
        be used to validate other certificates in a certificate chain, our rogue
        certificate has the same flag set to "CA = TRUE". We are in possession of the
        private key corresponding to the public key in this rogue CA certificate. As a
        result we are able to issue any number of certificates to anybody we choose,
        and they will be recognized as valid certificates by anybody trusting the real CA,
        which is all Internet users using one of the common web browsers.</p>
    </td></tr>
<tr><td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        <a name="sec52">5.2. Validity period and serial number prediction</a>
    </td><td><td width="800">
    <p>The first big challenge was to figure out a way to predict the validity period and serial
    numbers of the certificates issued by a Certification Authority, since these are the only
    two fields in the chosen prefix that the attacker does not control directly.</p>

    <p>Predicting the validity period of the certificate turned out to be an easy task. The system
    used by RapidSSL and FreeSSL for issuing certificates is fully automated and each certificate is
    issued exactly 6 seconds after the user clicks on the final "Ok" button to complete the
    purchase. Since the timestamps in the certificate validity period field use granularity in seconds, we could easily
    click this button at an arbitrary time T-6 seconds and get a certificate with a validity from
    time T to T+(1 year). With full control over the validity period, we move on to solving the
    serial number prediction problem.</p>

    <p>We estimated that it would take us 3 days to generate our pair of colliding certificates,
    which meant that we needed to predict the serial number of the certificate
    three days in advance. Most of the certificates in our data set had serial numbers that looked
    random and thus hard to predict, but we noticed that RapidSSL and FreeSSL were using sequential
    serial numbers.</p>

    <p>One can think of the sequential serial number as a remote counter. Each certificate we
    purchase from the CA reveals the current value of the counter and increments it by one.
    During the normal operation of the Certification Authority, the counter is incremented based on
    the number of the issued certificates. Statistical analysis of the serial numbers from the
    9,251 certificates in our RapidSSL data set revealed that on average this number has a pretty
    low variance.  In a three day period from Thursday night to Sunday night, the CA typically
    issues between 800 and 1000 certificates:</p>

    <p><img src="./MD5 considered harmful today_files/rapidssl-weekend.png" width="717" height="429"></p>

    <p>The anomaly with the last data point in the graph above is a result of the 100 certificates
    we purchased during one particular weekend at the end of September. Without our involvement, the
    increment during that weekend would have been a little less than 1000.</p>

    <p>With this information, we decided on the following plan: On Thursday night, we would purchase
    a certificate to get the current value of the serial number S. We would predict that on Sunday
    night (time T) the serial number would be a little less than S+1000. A few hours before time T,
    we would start purchasing certificates to push up the serial number closer and closer to the
    target number, finally getting it to S+999 about 30 seconds before time T. If we were lucky and
    the CA received no other certificate request during those last 30 seconds, we would be able to
    send a request at time T and get our predicted serial number.</p>

</td></tr><tr><td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        5.3. Constructing colliding certificates
    </td><td><td width="800">
        <p>In this section a detailed description is given of the contents of the two
        certificates with identical signatures that we now have. The certificate we obtained from the
        commercial CA will hereafter be called the "real certificate". Its sibling
        certificate is our "rogue CA certificate", and it is a sibling in the sense that
        the "to-be-signed" parts of these certificates were constructed together, to
        constitute a collision for the MD5 hash function.</p>

        <p>The real certificate was requested from the CA by sending it a "Certificate
        Signing Request" (CSR). The initial engineering task we had to do is to
        construct the contents of the CSR and the structure and contents of the rogue
        CA certificate in such a way that the resulting real certificate (constructed
        by the CA) and the rogue CA certificate (constructed by us) will be perfectly
        aligned. The second, and much more intricate, engineering task was to predict
        the contents of various fields in the real certificates, and based on this,
        construct the contents of various other fields in both certificates, in such
        a way that we would be able to obtain an MD5 collision.</p>

        <p>Complying with the X.509 standard <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[HPFS]</a>, each of the two certificates consists of:
        </p><ul>
        <li>a header of 4 bytes,
        </li><li>a so called "to-be-signed" part of 927 bytes,
        </li><li>a so called "signature algorithm" field of 15 bytes,
        </li><li>a "signature" field of 131 bytes.
        </li></ul>
        The picture below shows in great detail the alignment and most of the contents of
        the two certificates. The colors green, yellow and red respectively indicate the chosen prefixes,
        the collision blocks and the suffixes. Click on picture to get it in better resolution in pdf format in a new window.
        <p></p>

        <p><a href="http://www.win.tue.nl/hashclash/rogue-ca/downloads/alignment.pdf" target="_blank"><img src="./MD5 considered harmful today_files/alignment.png"></a></p>
    </td></tr>
<tr><td><td>&nbsp;</td><td></tr>
<tr valign="top"><td width="200" align="right">
        5.3.1. The real certificate and the CSR
    </td><td><td width="800">
        <p>The structure of the "to-be-signed" part of the real certificate is prescribed
        by the CA. We have control over contents and length of a few fields only.
        The structure is as follows:</p>

        <p><table width="100%">
        <tbody><tr><td valign="top" width="120">byte   0 -   3:</td><td>header</td></tr>
        <tr><td valign="top" width="120">byte   4 -   8:</td><td>version number (3, default value)</td></tr>
        <tr><td valign="top" width="120">byte   9 -  13:</td><td>serial number (643015, set by CA and predicted by us)</td></tr>
        <tr><td valign="top" width="120">byte  14 -  28:</td><td>signature algorithm ("md5withRSAEncryption", set by CA)</td></tr>
        <tr><td valign="top" width="120">byte  29 - 120:</td><td>issuer Distinguished Name
                        (CA default value)</td></tr>
        <tr><td valign="top" width="120">byte 121 - 152:</td><td>validity ("from 3 Nov. 2008 7:52:02 to 4 Nov. 2009 7:52:02",
                        set by CA and predicted by us)</td></tr>
        <tr><td valign="top" width="120">byte 153 - 440:</td><td>subject Distinguished Name<br>
                        (Country = "US",<br>
                         Organisation =
                     "i.broke.the.internet.and.all.i.got.was.this.t-shirt.phreedom.org",<br>
                         Organisational Unit (3 fields set by the CA) <br>
                         Common Name =
                     "i.broke.the.internet.and.all.i.got.was.this.t-shirt.phreedom.org",<br>
                         Country, Organisation and Common Name set by us in the CSR)</td></tr>
        <tr><td valign="top" width="120">byte 441 - 734:</td><td>subject public key info:<br>
                        <table width="100%">
                        <tbody><tr><td valign="top" width="120">byte 441 - 444:</td><td>header</td></tr>
                        <tr><td valign="top" width="120">byte 445 - 459:</td><td>public key algorithm
                                        ("RSAEncryption", set by us in the CSR)</td></tr>
                        <tr><td valign="top" width="120">byte 460 - 468:</td><td>headers</td></tr>
                        <tr><td valign="top" width="120">byte 469 - 729:</td><td>RSA modulus
                                        (2048 bit value, set by us in the CSR)</td></tr>
                        <tr><td valign="top" width="120">byte 730 - 734:</td><td>RSA public exponent
                                        (65537, set by us in the CSR)</td></tr>
                        </tbody></table></td></tr>
        <tr><td valign="top" width="120">byte 735 - 926:</td><td>extensions:<br>
                        <table width="100%">
                        <tbody><tr><td valign="top" width="120">byte 735 - 740:</td><td>headers</td></tr>
                        <tr><td valign="top" width="120">byte 741 - 756:</td><td>key usage ("digital signature, nonrepudiation,
                                            key encipherment, data encipherment",
                                        set by CA)</td></tr>
                        <tr><td valign="top" width="120">byte 757 - 881:</td><td>subject key identifier, crl distribution points, authority key identifier
                                        (uninteresting fields, set by CA)</td></tr>
                        <tr><td valign="top" width="120">byte 882 - 912:</td><td>extended key usage ("server authentication,
                                            client authentication", set by CA)</td></tr>
                        <tr><td valign="top" width="120">byte 913 - 926:</td><td>basic constraints
                                        ("CA = FALSE, Path Length = None", set by CA)</td></tr>
                        </tbody></table></td></tr>
        </tbody></table></p><p>

        </p><p>To obtain this certificate we constructed a Certificate Signing Request (CSR),
        according to the required PKCS#10 format. This request contains the following
        data:
        </p><ul>
        <li> "to-be-signed" part:
            <ul>
            <li> version number (1)
            </li><li> subject Country = "US"
            </li><li> subject Common Name =
                        "i.broke.the.internet.and.all.i.got.was.this.t-shirt.phreedom.org"
                (used by the CA for the fields Organisation and Common Name)
            </li><li> public key algorithm ("RSAEncryption")
            </li><li> public key (consisting of the RSA modulus and the RSA exponent)
            </li></ul>
        </li><li> signature algorithm ("md5withRSAEncryption")
        </li><li> signature (2048 bit value, computed with our private key over the "to-be-signed"
            part, this signature can be verified with the public key inside the request,
            in this way the CA can be certain that the requestor is in possession of the
            corresponding private key)
        </li></ul><p></p>

        <p>The requirements for the construction of the key pair for the real certificate were as follows:
        </p><ul>
        <li> the modulus should be a 2048 bit value,
        </li><li> as public exponent we conveniently chose 65537, as usual,
        </li><li> the corresponding private key is required to be known by us, because with it
          the CSR has to be signed,
        </li><li> the collision blocks are hidden in the modulus.
        </li></ul>
        The alignment turned out such that the 256 byte modulus starts at byte 474.
        This means that we have 38 bytes of the current 512 bit MD5 input block left.
        The first 26 bytes of those were simply chosen at random.
        The last 12 bytes of those were used as "birthday bits", see below for further
        explanation.<p></p>

        <p>Then we had three "near collision blocks" of 512 bits (i.e. 64 bytes) each.
        The entire "collision block" thus consists of 96 + 3 x 512 = 1632 bits, i.e. 204
        bytes.</p>

        <p>At the end of the last near collision block the MD5 collision is established.
        The collision block was computed by the collision finding method described
        below. That means that we do not have much control over its contents, we simply
        have to accept the random looking data that comes out of the cluster of game
        consoles.</p>

        <p>Then we have 256 - 26 - 204 = 26 bytes (= 208 bits) left in the
        modulus. We used them to make sure that the modulus will have the form of a
        product of two primes, known to us, in such a way that we can also compute the
        corresponding private exponent. This is done as follows.</p>

        <p>We start with a fixed bit string <code>B</code> of 1840 bits (230 bytes, namely 38 bytes to
        reach alignment with MD5 input blocks, plus 3 x 64 bytes for 3 near collision
        blocks). We now want to append another bit string <code>S</code> of 208 bits (26 bytes) such
        that the resulting 2048 bit <code>B||S</code> represents an integer which is a reasonably
        secure RSA modulus, i.e. a number <code>n=p×q</code> with <code>p,q</code> prime, that withstands
        current factoring methods. In order to find such <code>S</code>, we pick a random 224 bit
        integer <code>q</code>, and then hope that there is an integer <code>p</code> such that <code>B||S</code> represents
        the number <code>n=p×q</code>. Then we hope that both <code>p,q</code> are prime. If our hopes turn
        out to be false, we simply try another random value <code>q</code>, until we succeed.</p>

        <p>This method seems coarse, but we don't know how to do it better, and it works well in
        practice. The reason is as follows. The value of <code>n</code> we are looking for lies in
        the interval <code>B×2<sup>208</sup>&#8804;n&lt;(B+1)×2<sup>208</sup></code>. For a given <code>q</code> of <code>k</code> bits this
        means that the interval from <code>(B/q)×2<sup>208</sup></code> to <code>((B+1)/q)×2<sup>208</sup></code> should
        contain an integer <code>p</code>, and furthermore that the integers <code>p,q</code> both are prime.
        As the width of this interval is <code>2<sup>208</sup>/q</code>, which is approximately <code>2<sup>208-k</sup></code>,
        we have to try approximately <code>2<sup>k-208</sup></code> times before we find such an integer <code>p</code>
        lying in the proper interval, irrespective of primality. The probability that <code>q</code>
        is prime is approximately <code>1</code> in <code>log(2<sup>k</sup>)=k×log(2)</code>. Next, note that <code>p</code> has
        approximately <code>2048-k</code> bits. The probability that such a number is prime is
        approximately <code>1</code> in <code>log(2<sup>2048-k</sup>)=(2048-k)×log(2)</code>. This means that we
        have to generate approximately <code>2<sup>k-208</sup>×k×(2048-k)×(log(2))<sup>2</sup></code> numbers
        <code>q</code> of <code>k</code> bits before we can expect one hit. In only <code>k×(2048-k)×(log(2))<sup>2</sup></code>
        cases we have to test a <code>k</code> bit number for primality, and in only
        <code>(2048-k)×log(2)</code> cases we have to test a <code>2048- </code> bit number for primality.
        We chose <code>k=224</code>, which turned out to be doable in practice. The time required
        for computing this secure modulus was a couple of minutes only on a standard PC.</p>

        <p>The resulting RSA modulus thus is rather unbalanced: its prime factors have
        1824 and 224 bits respectively. This is estimated to be just out of reach of
        current factoring methods, in particular ECM.</p>

        <p>Note that the private key corresponding to the real certificate is used only for
        signing the CSR, and that the real certificate itself is used only for providing
        us with a valid signature. This certificate and corresponding key pair will
        never be used in some real application, though such use would in principle not
        harm anybody. An interesting consequence of this is that the creation of a
        secure RSA modulus is not necessary at all, we could have taken any number for <code>n</code>
        of which we know the factorisation, such that <code>&#966;(n)</code> is coprime to our public
        exponent 65537. The reason that we need the factorisation is that we need to
        compute the private exponent, as we have to sign the CSR. There is even no need
        for <code>n</code> to be a product of two primes, having a prime or any kind of factorisation
        would also do. Nevertheless we chose to be careful here too, and to make it a
        secure RSA modulus of which the private key will be kept secret as well.</p>

        <p>An interesting point to make is that the "path length" field in the "basic
        constraints" field of the CA's root certificate is not set. The path length
        field is the maximum number of intermediate CA levels in the CA hierarchy that
        this CA will allow between its own level and the end user level. If the CA would
        have set the path length to 0, then applications checking for the path length
        would have rejected certificates signed by our rogue CA, as there the path
        length is 1: our rogue CA is at the level between the end user certificate and
        the root CA certificate.</p>

        <p>For the collision construction it is absolutely necessary that we are able to
        predict at bit level the entire contents of the "to-be-signed" part of the
        certificate up to the point where the collision block starts. The only fields that
        are not either constant, or directly controlled by us are the validity period and
        the serial number. However, using the techniques described in <a href="http://www.win.tue.nl/hashclash/rogue-ca/#sec52">section
        5.2</a>, we were able to predict the values of these two fields.</p>
    </td></tr>
<tr><td><td>&nbsp;</td><td></tr>
<tr valign="top"><td width="200" align="right">
        5.3.2. The rogue CA certificate
    </td><td><td width="800">
        <p>The structure of the "to-be-signed" part of the rogue CA certificate is
        chosen by us (but of course within the limits of the X.509 standard),
        to facilitate the collision construction process. Here the
        only field prescribed by the CA is the issuer Distinguished Name.
        The structure of the rogue CA certificate is as follows:</p>

        <p><table width="100%">
        <tbody><tr><td valign="top" width="120">byte   0 -   3:</td><td>header</td></tr>
        <tr><td valign="top" width="120">byte   4 -   8:</td><td>version number (3, default value)</td></tr>
        <tr><td valign="top" width="120">byte   9 -  11:</td><td>serial number (65, arbitrary choice)</td></tr>
        <tr><td valign="top" width="120">byte  12 -  26:</td><td>signature algorithm ("md5withRSAEncryption", set by us in the CSR)</td></tr>
        <tr><td valign="top" width="120">byte  27 - 118:</td><td>issuer Distinguished Name
                        (CA default value)</td></tr>
        <tr><td valign="top" width="120">byte 119 - 150:</td><td>validity ("from 31 Jul. 2004 0:00:00 to 2 Sep. 2004 0:00:00")</td></tr>
        <tr><td valign="top" width="120">byte 153 - 212:</td><td>subject Distinguished Name<br>
                        (Common Name =
                            "MD5 Collisions Inc. (http://www.phreedom.org/md5)")</td></tr>
        <tr><td valign="top" width="120">byte 213 - 374:</td><td>subject public key info:<br>
                        <table width="100%">
                        <tbody><tr><td valign="top" width="120">byte 213 - 215:</td><td>header</td></tr>
                        <tr><td valign="top" width="120">byte 216 - 230:</td><td>public key algorithm ("RSAEncryption")</td></tr>
                        <tr><td valign="top" width="120">byte 231 - 237:</td><td>headers</td></tr>
                        <tr><td valign="top" width="120">byte 238 - 369:</td><td>RSA modulus (1024 bit value)</td></tr>
                        <tr><td valign="top" width="120">byte 370 - 374:</td><td>RSA public exponent (65537)</td></tr>
                        </tbody></table></td></tr>
        <tr><td valign="top" width="120">byte 375 - 926:</td><td>extensions:<br>
                        <table width="100%">
                        <tbody><tr><td valign="top" width="120">byte 375 - 378:</td><td>headers</td></tr>
                        <tr><td valign="top" width="120">byte 379 - 395:</td><td>key usage ("digital signature, nonrepudiation,
                                            certificate signing, offline CRL signing,
                                            CRL signing")</td></tr>
                        <tr><td valign="top" width="120">byte 396 - 412:</td><td>basic constraints
                                        ("CA = TRUE, Path Length = None")</td></tr>
                        <tr><td valign="top" width="120">byte 413 - 476:</td><td>subject key identifier, authority key identifier (uninteresting fields)</td></tr>
                        <tr><td valign="top" width="120">byte 477 - 926:</td><td>tumor (Netscape extension)</td></tr>
                        </tbody></table></td></tr>
        </tbody></table></p>

        <p>The field that makes this certificate a "CA certificate" is the "basic
        constraints" fields, with the value "CA = TRUE".</p>

        <p>The RSA key pair, of which the public key is inside the rogue CA certificate,
        was generated by OpenSSL in a standard key pair generation process. The private
        key is kept in a safe place and we're not planning on releasing it publicly.
        This private key is required for issuing end user
        certificates signed by the rogue CA, so this is quite sensitive.</p>

        <p>To minimize this danger, the validity period of the rogue CA certificate is set to a relatively short
        period in the year 2004 (the month August 2004, when Xiaoyun Wang presented the
        first MD5 collision at the Crypto Conference in Santa Barbara). This backdating
        is done on purpose. It means that even if the private key to our rogue CA certificate
        falls into the wrong hands, the certificate would be rejected by all common browsers
        because of its expiration date, except when the system clock of the
        user's computer would be set back to within this short period in 2004. The
        probability that this will happen unintentionally is negligible.</p>

        <p>Note that the serial number we have chosen is a rather low one. We do not know
        whether an actual certificate issued by this CA with this serial number was
        already in existence. We took a low number because that most probably implies
        that a possible other certificate with that serial number has already expired a
        long time ago.</p>
    </td></tr>
<tr><td><td>&nbsp;</td><td></tr>
<tr valign="top"><td width="200" align="right">
        5.3.3. Alignment
    </td><td><td width="800">
        <p>The bytes 0 - 473 in the real certificate (the fields up to the modulus, and the first
        5 bytes of the modulus field which are a predictable header) are pretty much fixed by CA
        requirements. Those 474 bytes form the "chosen prefix" on the real certificate's
        side. For this certificate we chose to have a 2048 bit RSA key. The main reason
        for this size is the fact that we have to hide the collision block in there. Our collision
        construction method enables us to make collision blocks of 1632 bits, so
        2048 seems a reasonable choice. Moreover 2048 bit RSA moduli are quite common,
        so no suspicion is raised.</p>

        <p>At the side of the rogue certificate we could not use the public key modulus for
        hiding the collision block. The reason for this is that we want to set the CA
        flag in the "basic constraints" field to the value "TRUE", contrary to the
        corresponding field in the real certificate. The problem is that this "basic
        constraints" field occurs after the public key, and with the type of collisions
        we have, we cannot allow any bit difference after the collision block. So in the
        rogue CA certificate, both the public key and the extensions up to the "basic
        constraints" field have to be placed before the collision block starts.</p>

        <p>To accomplish this, it was helpful that the subject Distinguished Name in the real certificate has
        considerable length, that can easily be stretched by choosing an appropriately
        sized Common Name. At the same time we took the subject Distinguished Name in the
        rogue CA certificate as short as possible, to allow sufficient space for a full
        1024 bit public key and the "basic constraints" field, all this to be
        placed in the area corresponding to
        the subject Distinguished Name field of the real certificate. In this way all
        necessary fields belonging to the "chosen prefix" of the rogue CA certificate
        could be placed in the first 477 bytes of the "to-be-signed" part.</p>

        <p>The next problem that had to be solved is that we need a field in the extensions
        of the rogue CA certificate in which we have to hide at least 3 × 512 + 96 =
        1632 bits (204 bytes) of the collision block. This is random looking data, over
        which we do not have much control, as this data comes out of the collision
        construction method, and we do not control that enough to be able to make such a
        block with some real world interpretation. And we have one more problem, as all
        data after the public key from the real certificate needs to be copied bitwise
        into the rogue CA certificate. This data does have an interpretation relevant to
        the real certificate, but this interpretation most probably is not relevant,
        even disturbing, for the rogue CA certificate. Together those fields have a
        considerable size, namely 427 bytes.</p>

        <p>These two problems together ask for a place in the rogue CA certificate to hide
        427 bytes of data in, some of which are random looking, and some of which have
        an interpretation that should not be shown in certificate viewers. The solution
        we adopted is to define a so called "Netscape Comment" block. This is a
        proprietary extension in which any data can be stored, which will be ignored by
        most certificate processing applications, including the major browsers. There is
        a small problem here in that formally the contents of this field must be of type
        IA5String, and our content is not of that form. An ASN.1 parser that strictly
        follows the standard will complain about this, as happens e.g. with Peter
        Gutmann's program "dumpasn1". But as most application software ignores the
        extension anyway, the certificate with this standard violating field in it will
        still be accepted in practice. It is conceivable that the 427 bytes could have
        been hidden in a different extension field (there is even an
        <a href="http://www.cs.auckland.ac.nz/~pgut001/pubs/dave.der">X.509 certificate with
        a movie hidden inside</a>).</p>

        <p>The Netscape Comment extension requires a header of 23 bytes. So the contents of
        the extension will start at byte 500, and that now can become exactly the spot
        where the birthday bits start, in both certificates. This explains the fact that
        in the real certificate, where the modulus starts at byte 474, there are first
        26 random bytes to fill up the space. In a technical sense the "chosen prefixes"
        of the two certificates end at byte 499. The collision block starts at byte 500.
        This collision block consists, as said before, of 96 + 3 × 512 = 1632 bits = 204
        bytes, so it ends at byte 703.</p>

        <p>So from byte 500 until byte 926 there are 427 bytes inside the rogue CA
        certificate that are quite meaningless to the certificate itself. We call this
        big, seemingly unnecessary block of data a "tumor". From our point of view it's a benign
        one.</p>

        <p>We start the modulus of the public key of the real certificate at byte 474. As
        explained above, for alignment with the rogue CA certificate we need to fill up
        the first 26 bytes somehow, so we just chose 26 random bytes to start the
        modulus with. We have to think in terms of blocks of 64 bytes, as MD5 splits up
        the input in 512 bit blocks. So we now have 12 bytes left until the next 512 bit
        block starts with a new <code>IHV</code> value.</p>

        <p>So at byte 500 of the "to-be-signed" part we have reached the stage where in the
        real certificate we are inside the modulus, and in the rogue CA certificate we
        are inside the tumor.</p>

        <p>The MD5 collision construction method we used consists of two stages: a
        "birthdaying" stage and a "near collision" stage. The birthdaying stage is meant
        to prepare the next difference in <code>IHV</code>s between the two certificates, at the
        border between two 512 bit blocks. Thus we have 12 bytes, i.e. 96 bits,
        available for those birthday bits. This is, due to improvements in the
        birthdaying procedure, more than enough. In fact, we needed only 72 bits for our
        new technique of birthdaying, so of the 12 available bytes three were simply
        set to 0. Note that, by their very nature, these 72 birthday bits are
        completely different in both certificates, and look completely random. These
        birthday bits were computed by our collision finding programs, for details see
        below.</p>

        <p>Then there are three MD5 input blocks of 512 bits each, i.e. 3 × 64 bytes,
        byte numbers 512 to 703. Each of the three input blocks was constructed by our
        collision finding method to cancel out certain differences in the <code>IHV</code>s. Contrary
        to the birthday bits, these near collision blocks differ only in one or two bits.
        At the
        end of the third block the difference has vanished entirely, thus constituting
        a collision for the MD5 compression function. From byte 704 on the certificates
        are exactly, i.e. bitwise, identical.</p>

        <p>In the real certificate we now have 26 + 12 + 3 × 64 = 230 bytes of the modulus.
        The remaining 26 bytes of the modulus were computed to ensure that it's a
        secure RSA modulus, as explained above.</p>

        <p>Then in the real certificate the public exponent and all "version 3 extensions"
        follow. In total this required 197 bytes. They were generated in the real
        certificate by the CA, and then simply copied into the tumor in the rogue CA
        certificate. One of the fields in there is the "basic constraints" field, set
        to "CA = FALSE". Interestingly enough, the bytes of this field are also present
        in the tumor, but the certificate processing software will not recognize them as
        having any interpretation attached to them, as they are part of the tumor.</p>

        <p>After the extensions in the real certificate and the tumor in the rogue CA
        certificate have ended, at byte 926, the "to-be-signed" part of the certificates
        are finished, and the MD5 hash function can be called on these 926 byte long
        strings to produce the colliding value.</p>

        <p>What finally follows inside the certificate are the "signature algorithm" field
        and the "signature" field. Naturally, those fields are identical in both the
        certificates.</p>

        <p>For download: binary files containing both "to-be-signed" parts:
        </p><ul>
        <li><a href="http://www.win.tue.nl/hashclash/rogue-ca/downloads/real.cert.tbs.bin">"to-be-signed" part of real certificate, binary file</a>
        </li><li><a href="http://www.win.tue.nl/hashclash/rogue-ca/downloads/real.cert.tbs.hex" target="_blank">"to-be-signed" part of real certificate, human-readable hexadecimal file</a>
        </li><li><a href="http://www.win.tue.nl/hashclash/rogue-ca/downloads/rogue_ca.cert.tbs.bin">"to-be-signed" part of rogue CA certificate, binary file</a>
        </li><li><a href="http://www.win.tue.nl/hashclash/rogue-ca/downloads/rogue_ca.cert.tbs.hex" target="_blank">"to-be-signed" part of rogue CA certificate, human-readable hexadecimal file</a>
        </li></ul><p></p>

        <p>To check that the two "to-be-signed" parts collide, run an MD5 program on the binary files.
        To check that the two "to-be-signed" parts differ, run e.g. a SHA-1 program on the binary files.</p>

        <p>Here are the MD5 Intermediate Hash Values:</p>

        <p><table border="1">
        <tbody><tr><td><code>IHV</code></td><td>real certificate</td><td>rogue CA certificate</td></tr>
        <tr><td><code>IHV<sub>0</sub></code></td><td><code>0123456789ABCDEFFEDCBA9876543210</code></td><td><code>0123456789ABCDEFFEDCBA9876543210</code></td></tr>
        <tr><td><code>IHV<sub>1</sub></code></td><td><code>058484A77F07A36382AAECF2DFE207A2</code></td><td><code>713F764E78B5C9B03F8878F7A440551B</code></td></tr>
        <tr><td><code>IHV<sub>2</sub></code></td><td><code>D52743425C3DAC23A9E62C6C9670622E</code></td><td><code>2AC9681DDB3B72D29A1422A515C9E4F4</code></td></tr>
        <tr><td><code>IHV<sub>3</sub></code></td><td><code>7789E58E3B45621A3E46A64CA9D7AC3A</code></td><td><code>104DD09F9F651E554C528578AC1F6885</code></td></tr>
        <tr><td><code>IHV<sub>4</sub></code></td><td><code>CDA2CB5673D3D32092C7F1EF80CE5729</code></td><td><code>15ADC95447929A2AC0EACF9E618E14EB</code></td></tr>
        <tr><td><code>IHV<sub>5</sub></code></td><td><code>F08E24604482508B959A0B5762207A3F</code></td><td><code>D6D6E59C0BDB1F701CB04C29A0573EA0</code></td></tr>
        <tr><td><code>IHV<sub>6</sub></code></td><td><code>A83EA6CCCC50B41A4BFADBC6D856B338</code></td><td><code>3AAB0CE98F1E9B2AC270A5A2C60FF605</code></td></tr>
        <tr><td><code>IHV<sub>7</sub></code></td><td><code>0B42EAAB4258AACA8C30BDB8192A1BC0</code></td><td><code>DE3CCC11526732CA0FD8B9F5992A7673</code></td></tr>
        <tr><td><code>IHV<sub>8</sub></code></td><td><code>D21CED8CC56726B6BF2AE4A93D742C3A</code></td><td><code>D21CED8CCE3D7EB4C82ADCA94674243A</code></td></tr>
        <tr><td><code>IHV<sub>9</sub></code></td><td><code>DC1EDBFFF3C3E9E7BCEB3F9E2D0705BD</code></td><td><code>DC1EDBFFF49941E8BDEB379E2E07FDBC</code></td></tr>
        <tr><td><code>IHV<sub>10</sub></code></td><td><code>F0D655805A71A74EF8A6A630D11977D8</code></td><td><code>F0D655805A479F4EF8A69E30D1196FD8</code></td></tr>
        <tr><td><code>IHV<sub>11</sub></code></td><td><code>9808B5471E7130CC5A30A2ABF2BE4B4D</code></td><td><code>9808B5471E7130CC5A30A2ABF2BE4B4D</code></td></tr>
        <tr><td><code>IHV<sub>12</sub></code></td><td><code>AA1F57B21A8732130CB0CAEF4BB9C746</code></td><td><code>AA1F57B21A8732130CB0CAEF4BB9C746</code></td></tr>
        <tr><td><code>IHV<sub>13</sub></code></td><td><code>151754FA2FCC5914E72B71B4300B6485</code></td><td><code>151754FA2FCC5914E72B71B4300B6485</code></td></tr>
        <tr><td><code>IHV<sub>14</sub></code></td><td><code>271EECDC4DAC9E9C471C34C833917E26</code></td><td><code>271EECDC4DAC9E9C471C34C833917E26</code></td></tr>
        <tr><td><code>IHV<sub>15</sub></code></td><td><code>9ED7B966BD815C141B899DC64B528564</code></td><td><code>9ED7B966BD815C141B899DC64B528564</code></td></tr>
        <tr><td>MD5</td><td><code>9ED7B966BD815C141B899DC64B528564</code></td><td><code>9ED7B966BD815C141B899DC64B528564</code></td></tr>
        </tbody></table></p>

        <p>Here are the XOR differences of the MD5 Intermediate Hash Values:</p>

        <p><table border="1">
        <tbody><tr><td><code>IHV</code></td><td>XOR difference</td></tr>
        <tr><td><code>IHV<sub>0</sub></code></td><td><code>00000000000000000000000000000000</code></td></tr>
        <tr><td><code>IHV<sub>1</sub></code></td><td><code>74BBF2E907B26AD3BD2294057BA252B9</code></td></tr>
        <tr><td><code>IHV<sub>2</sub></code></td><td><code>FFEE2B5F8706DEF133F20EC983B986DA</code></td></tr>
        <tr><td><code>IHV<sub>3</sub></code></td><td><code>67C43511A4207C4F7214233405C8C4BF</code></td></tr>
        <tr><td><code>IHV<sub>4</sub></code></td><td><code>D80F02023441490A522D3E71E14043C2</code></td></tr>
        <tr><td><code>IHV<sub>5</sub></code></td><td><code>2658C1FC4F594FFB892A477EC277449F</code></td></tr>
        <tr><td><code>IHV<sub>6</sub></code></td><td><code>9295AA25434E2F30898A7E641E59453D</code></td></tr>
        <tr><td><code>IHV<sub>7</sub></code></td><td><code>D57E26BA103F980083E8044D80006DB3</code></td></tr>
        <tr><td><code>IHV<sub>8</sub></code></td><td><code>000000000B5A5802770038007B000800</code></td></tr>
        <tr><td><code>IHV<sub>9</sub></code></td><td><code>00000000075AA80F010008000300F801</code></td></tr>
        <tr><td><code>IHV<sub>10</sub></code></td><td><code>00000000003638000000380000001800</code></td></tr>
        <tr><td><code>IHV<sub>11</sub></code></td><td><code>00000000000000000000000000000000</code></td></tr>
        <tr><td><code>IHV<sub>12</sub></code></td><td><code>00000000000000000000000000000000</code></td></tr>
        <tr><td><code>IHV<sub>13</sub></code></td><td><code>00000000000000000000000000000000</code></td></tr>
        <tr><td><code>IHV<sub>14</sub></code></td><td><code>00000000000000000000000000000000</code></td></tr>
        <tr><td><code>IHV<sub>15</sub></code></td><td><code>00000000000000000000000000000000</code></td></tr>
        <tr><td>MD5</td><td><code>00000000000000000000000000000000</code></td></tr>
        </tbody></table></p>

        <p>The SHA-1 hash values respectively are <code>1AA8050F29EECAAFE1F6815487FF164783129E63</code> and
        <code>5D23230D1B36C8DDD21CB5ABDAED46967D1ED4AD</code>.</p>

        <p>The differences in the MD5 <code>IHV</code>s are depicted in the following image.</p>

        <p><img src="./MD5 considered harmful today_files/diff.png" width="512"></p>

        <p>Each line represents the 128 bits of one <code>IHV</code> difference (this time not the XOR difference
        but the difference in non-adjacent form for 32 bit words; a black
        pixel stands for no difference, a blue pixel stands for a +1 difference, an orange
        pixel stands for a -1 difference).
        It is clear that the <code>IHV</code> difference looks random in <code>IHV<sub>1</sub></code> to <code>IHV<sub>7</sub></code>,
        gets special in <code>IHV<sub>8</sub></code> (this is due to the birthdaying), and then gets canceled
        out piece by piece in the next three input blocks, so that it has completely
        vanished in <code>IHV<sub>11</sub></code>.</p>
    </td></tr>
<tr><td><td>&nbsp;</td><td></tr>
<tr valign="top"><td width="200" align="right">
        5.3.4. Collision construction
    </td><td><td width="800">
        <p><img src="./MD5 considered harmful today_files/botsing.png" style="float: right; margin: 10px 5px;">
        The chosen-prefix collision construction method is basically described in our
        EuroCrypt 2007 paper <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[SLW]</a>. However, some crucial improvements
        to this method have been developed that made the present application possible.
        Details of those improvements have been made available in an
        academic paper <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[SSALMOW]</a>. The basic
        idea of the method is twofold. In the second part of the method differential paths
        are constructed that are capable of eliminating special bit differences in the
        <code>IHV</code>s with certain probabilities. This can be called a search for
        near collisions. In a few consecutive "near collision blocks" thus
        special combinations of bit differences can be eliminated.
        For each bit difference a fresh differential path has to be constructed, so it is
        crucial to have an automated way to produce differential paths.</p>

        <p>The first part of the method prepares the <code>IHV</code> difference so that it
        becomes suitable for the second part. This is simply done by a birthday search
        for an input pair that has an <code>IHV</code> difference with the proper structure.
        Optimization of the trade-off between the number of birthday bits and the number
        of near collision blocks is another item that is discussed in the
        paper <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[SSALMOW]</a>.
        In the case at hand we decided to choose for 72 birthday bits and 3 near
        collision blocks. The computational bottleneck is the birthday search.</p>

        <p>To illustrate the collision construction we have made some nice pictures of bit differences
        in the internal states of MD5.</p>

        <p><img src="./MD5 considered harmful today_files/botsing.gif" width="512"></p>

        <p>The entire inputs for MD5 consist of pairs of 15 input blocks of 512 bits each.
        In each compression function call the input <code>IHV</code> is put into an
        internal state of 128 bits. The compression function performs 64 rounds, in each round
        updating the state, using some bits from the input block. After the 64th round the
        internal state is XORed with the input <code>IHV</code> to produce the output <code>IHV</code>.</p>

        <p>In the pictures above and to the right the differences between <code>IHV</code>s and the 64
        internal states in between the rounds are shown. Here each time the difference between
        the two input files are taken. These differences are computed in non-adjacent form for
        32 bit words. Each line in the pictures shows the 128 bits of an <code>IHV</code>or an
        internal state difference. In the animated picture above the first line, above the yellow
        division line at the top, shows the input <code>IHV</code> difference, the last line, below the yellow
        division line at the bottom, shows the output <code>IHV</code> difference, and the 64 lines
        in between the yellow division lines show the 64 internal state differences after each round.
        the animation shows the processing of the 15 compression function calls one at a time.
        The picture to the right shows the same data in one big row rather than animated. Note that each
        output <code>IHV</code> is the input <code>IHV</code> for the next compression function call.</p>

        <p><img src="./MD5 considered harmful today_files/ps3cluster.png" style="float: left; margin: 5px 10px;">
        A single attempt for constructing a chosen-prefix collision costs about a little more than a day.
        The first stage consisting of the
        birthday search is computationally the most expensive. Luckily
        it is also very suited for the special SPU cores of the Cell
        Processor that the Sony PlayStation 3 uses. We had more than 200 PS3s
        at our disposal, located at the <a href="http://www.win.tue.nl/~bdeweger/PS3Lab/" target="_blank">"PlayStation
        Lab"</a> of Arjen Lenstra's Laboratory for Cryptologic Algorithms at EPFL, Lausanne, Switzerland
        (see the picture; acquisition of this cluster was sponsored by EPFL DIT and by a matching equipment grant
        from the Swiss National Science Foundation).
        The birthdaying takes about 18 hours on the 200 PS3s using 30GB of
        memory that was equally divided over the PS3s.
        The second stage computes the 3 collision blocks that
        eliminate the <code>IHV</code>
        differences left after the first stage
        and costs in total about 3 to 10 hours on a high-end quadcore pc.
        This part is not suited for the PS3s SPU cores due to the
        large memory demands and the high number of branches in the software
        execution flow.
        Since the two stages are performed on different hardware, we
        were able to pipeline several attempts, so that within one weekend (72
        hours) we could easily perform 3 attempts (3 × 18 + 10 = 64 hours).
        The total complexity of the collision construction can be estimated at
        <code>2<sup>51.x</sup></code> MD5 compression function calls, when 30 GB
        of memory is available.</p>
    </td></tr>
<tr><td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        5.4. Real life execution
    </td><td><td width="800">
        <p>For one single attempt to obtain a CA signature we had to guess the serial number
        and the validity period the CA was going to use a few days in advance. This information is crucial to
        get the chosen prefix for the real certificate's "to-be-signed" part, and this
        is input for the collision construction method. Once a collision has been found,
        the public key modulus has to be computed. Then the Certificate Signing Request
        could be composed and sent to the CA at the precise time, and then we had to wait for the CA to return
        a signed certificate, and see if the serial number and validity period were guessed
        correctly.</p>

        <p>We performed our attemps over the weekend to take advantage of the lower load of the CA.
        Each weekend we would generate from one to three collisions with serial numbers within the
        predicted range and purchase enough certificates to increment the serial number up to the
        desired value. Unfortunately, the first three tries failed due to timing issues.</p>

        <p>We received a couple of certificates signed only a second too late
        and a number of times requests by other customers of the CA interfered
        with our attempts to get the right serial number. Finally, on the fourth
        weekend we succeeded in getting a certificate with the right serial number
        signed at the right time.</p>

        <p>Each certificate we purchased from RapidSSL cost us USD 45. However, the CA allowed us to
        reissue each certificate up to 20 times for free, which meant that a single certificate
        request cost us only USD 2.25. In total, we spent USD 657 on purchasing certificates for this project.</p>
    </td></tr>
<tr><td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        5.5. Results
    </td><td><td width="800">
        <p>The results of executing our scenario are two certificates.
        We make them available for download in the common .cer and .pem formats.
        Moreover we give the output of the
        <a href="http://www.cs.auckland.ac.nz/~pgut001/dumpasn1.c" target="_blank">"dumpasn1"</a>
        program applied to the certificates, to presents the certificate structure in a
        more readable form.</p>

        <p></p><ul>
        <li><a href="http://www.win.tue.nl/hashclash/rogue-ca/downloads/real.cert.cer">real certificate (.cer)</a>
        </li><li><a href="http://www.win.tue.nl/hashclash/rogue-ca/downloads/real.cert.pem">real certificate (.pem)</a>
        </li><li><a href="http://www.win.tue.nl/hashclash/rogue-ca/downloads/real.cert.txt" target="_blank">real certificate (output of dumpasn1)</a>
        </li><li><a href="http://www.win.tue.nl/hashclash/rogue-ca/downloads/rogue_ca.cert.cer">rogue CA certificate (.cer)</a>
        </li><li><a href="http://www.win.tue.nl/hashclash/rogue-ca/downloads/rogue_ca.cert.pem">rogue CA certificate (.pem)</a>
        </li><li><a href="http://www.win.tue.nl/hashclash/rogue-ca/downloads/rogue_ca.cert.txt" target="_blank">rogue CA certificate (output of dumpasn1)</a>
        </li></ul><p></p>

        <p>The private key for the certificate is not available for download, but this should not
        prevent anybody from verifying the authenticity of our certificate.</p>
    </td></tr>
<tr><td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        5.6. Demonstration
    </td><td><td width="800">
        <p><img src="./MD5 considered harmful today_files/certificate4.png" style="float: right; margin: 10px 5px;">
        To see our rogue CA certificate in action, set your computer's system clock to August 2004,
        and then click <a href="https://i.broke.the.internet.and.all.i.got.was.this.t-shirt.phreedom.org/" target="_blank">
        https://i.broke.the.internet.and.all.i.got.was.this.t-shirt.phreedom.org/</a>.
        Do not forget to reset your system clock afterwards.</p>

        <p>
        Here you can download in different formats the example website certificate signed by our rogue CA:</p><ul>
        <li><a href="http://www.win.tue.nl/hashclash/rogue-ca/downloads/website_localhost.cer">example website certificate signed by the rogue certificate (.cer)</a>
        </li><li><a href="http://www.win.tue.nl/hashclash/rogue-ca/downloads/website_localhost.pem">example website certificate signed by the rogue certificate (.pem)</a>
        </li><li><a href="http://www.win.tue.nl/hashclash/rogue-ca/downloads/website_localhost.txt" target="_blank">example website certificate signed by the rogue certificate (output of dumpasn1)</a>
        </li></ul><p></p>
    </td></tr>
<tr><td><hr></td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right"><b>
        <a name="sec6">6. Impact</a>
    </b></td><td><td width="800">
        <p>A short summary of our result is that we have come in possession of a
        "rogue" Certification Authority whose certificate will be accepted
        by default by most browsers. Thus we are able to issue SSL certificates to
        any website we like, including rogue websites claiming to be legitimate ones.</p>

        <p>This has been possible by exploiting the following weaknesses:
        </p><ul>
        <li>an efficient method to construct "chosen-prefix collisions" for
            the MD5 hash function,
        </li><li>there is at least one commercial Certification Authority that:
            <ul>
            <li>issues certificates with a signature created using the MD5 hash function,
            </li><li>processes online requests for certificates in an automated way,
            </li><li>does not check for anomalous requests,
            </li><li>allows predicting with reasonable probability of success a valid
                combination of serial number and validity period,
            </li><li>has no technically enforced limit on the length of a
                chain of certificates.
            </li></ul>
        </li></ul><p></p>

        <p>Any website, whether it is secure (i.e. uses SSL) or not, whether it
        has an MD5-based, SHA-1-based, SHA-256-based, or any other type of
        certificate, irrespective of which Certification Authority issued the
        certificate, can be impersonated, in particular not only genuine websites that have an MD5-based
        certificate are vulnerable.
        </p>

        <p>The rogue Certification Authority we have has been set up for demonstration
        purposes only. Its certificate has on purpose been backdated, so that it
        will be recognized by browsers as having expired more that 4 years ago.
        Moreover the corresponding private key, needed to issue certificates with,
        will be kept in a safe place to prevent abuse. Thus it is unlikely that with
        this particular rogue Certification Authority harm can be done.</p>

        <p>However, we have shown that it is possible in practice, with some non-negligible
        but doable effort, to set up such a rogue Certification Authority. If we can
        do it now, others will be capable of doing it as well in the foreseeable future.
        In theory it is even conceivable that other groups or individuals already have developed
        similar skills and knowledge as we have, and are already able to impersonate
        websites at their will. We have no indication that this is actually the case.
        Because of this we believe it is important to stop using MD5 as soon as possible.</p>

        <p>In combination with known weaknesses in the Domain Name System (DNS) protocol
        such as Kaminsky's "DNS Flaw" <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[K2]</a> (see also <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[OMM]</a>),
        the vulnerability we exposed opens the door to virtually undetectable phishing attacks. Without being
        aware of it, users can be redirected to malicious sites that appear exactly
        the same as the trusted banking or e-commerce websites they believe to be
        visiting. User passwords and other private data can fall into wrong hands.</p>

        <p>We do not want to help persons with criminal intent. Therefore we will for the
        time being not release the full details of how we have been able to obtain
        the rogue Certification Authority certificate. It should however be noted that
        the basic principles of constructing "chosen-prefix collisions" for
        MD5 were published already in May 2007, see <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[SLW]</a>, and the
        <a href="http://www.win.tue.nl/hashclash/ChosenPrefixCollisions/" target="_blank">"Chosen-prefix collisions"</a> website.
        To make our present results possible these publicly known techniques have
        been improved at crucial points. These improvements are published in an
        academic paper <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[SSALMOW]</a>. Apart from
        that, somebody who wants to redo our work has to do considerable implementation
        and optimization efforts. For the time being we do not plan to release
        such implementation details.</p>

        <p>Other applications than secure web communication using SSL might be vulnerable as well.
        Every Certification Authority that will honor requests for MD5-based certificates
        and that has sufficiently predictable serial numbers and validity periods, may
        be vulnerable to similar attacks. This may include Certification Authorities
        in the areas of e-mail signing and encryption, software signing, non-repudiation
        services, etc.</p>

        <p>We feel safe to say that the impact of our work is very limited in the sense
        that we think it is highly unlikely that our rogue Certification Authority
        can be abused by anyone (including ourselves!). We have released sufficient
        detail of our methods to show that we have a realistic attack scenario.
        The proof of the pudding is our colliding certificates, available for download
        on this website, so that everyone can verify our claims, and in the demonstration
        we have provided. Our intent is to raise awareness that MD5 is broken so
        drastically that its continued use in digital signature schemes and certificates
        poses realistic threats.</p>

        <p>Our desired impact is that Certification Authorities will
        stop using MD5 in issuing new certificates. We also hope that use of MD5 in other
        applications will be reconsidered as well. Proper alternatives are readily available.</p>
    </td></tr>
<tr><td><hr></td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        <a name="sec6">6.1. Revocation issues</a>
    </td><td><td width="800">
        <p>One interesting observation from our work is that the rogue certificate we have
        created is very hard to revoke using the revocation mechanism available in common
        browsers. There are two protocols for certificate revocation, CRL and OSCP. Until
        Firefox 3 and IE 7, certificate revocation was disabled by default. Even in the
        latest versions, the browsers rely on the certificate to include a URL pointing
        to a revocation server. Our rogue CA certificate had very limited space and it was
        impossible to include such a URL, which means that by default both Internet Explorer
        and Firefox are unable to find a revocation server to check our certificate against.</p>

        <p>As a workaround, system admistrators can configure the browsers to always query a
        company-specific OSCP server for revocation information, but this option is not
        easily usable by individual end users. This points out an important problem that
        still needs to be resolved, in case similar attacks result in certificates that
        need to be revoked in the future.</p>

        <p>Another interesting scenario is that our result opens possibilities for
        Denial of Service attacks on existing Certification Authorities. If an attacker
        wants to have somebody's certificate revoked (e.g. of a competing web shop),
        he can use our techniques to obtain a rogue certificate from the same Certification
        Authority, which has the same serial number as the target certificate. As soon
        as this rogue certificate gets published, the Certification Authority has no
        choice but to revoke it. Since revocation happens only on the basis of the
        serial number of the certificate, at the same time the legitimate certificate
        of the victim will be revoked. This attack will become extremely powerful
        if the root certificate of the Certification Authority is targeted.
        An attacker can thus force revocation of this root certificate, and with that
        of the entire certificate tree depending on it.</p>
    </td></tr>
<tr><td><hr></td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right"><b>
        <a name="sec7">7. Countermeasures</a>
    </b></td><td><td width="800">
        <p>First and foremost, there is no proper excuse for continued use of a broken cryptographic
        primitive when sufficiently strong alternatives are readily available, for example
        SHA-2.</p>

        <p>Secondly, there is no substitute for security awareness. Openness about security
        problems, vulnerabilities and technical possibilities is invaluable to make the
        Internet a safer place. Advice from experts should be taken seriously and early
        in the process. In this case, MD5 should have been phased out soon after 2004.</p>

        <p>This being said, we continue discussing countermeasures
        that can be taken by different stakeholders.</p>

        <p><img src="./MD5 considered harmful today_files/certificate1.png" style="float: right; margin: 10px 5px;">
        <b>Users</b> browsing the web might be redirected to a rogue website that has obtained
        an erroneously trusted SSL certificate. A user cannot do anything to prevent this
        from happening. She might try to detect it, but we realize that this is somewhat
        cumbersome for the average web user. The user may click on the proper button or
        menu item in the browser, to view details of the certificate for the website
        she is visiting. The used hash function is visible in the "Signature algorithm"
        field, see the picture to the right, where "md5RSA" means that MD5
        was used for signing the certificate. When all certificates in the chain up to the
        root CA certificate use other hash functions than MD5 such as SHA-1, our attack has not been used.</p>

        <p><img src="./MD5 considered harmful today_files/certificate2.png" style="float: left; margin: 5px 10px;">
        When MD5 has been used, fraud may be detected by inspection of the certificate at
        bit level. When the certificate has a "tumor" inside, this may or may
        not be shown in a user friendly certificate viewer. See the picture on the left,
        where there is a strange "Netscape comment" field with the value 3.
        Actually this is a 427 byte field that for technical reasons cannot be shown on
        screen in this viewer. An expert who can inspect the certificate with tools such
        as <a href="http://www.cs.auckland.ac.nz/~pgut001/dumpasn1.c" target="_blank">"dumpasn1"</a>,
        will be able to identify
        such a strange field in the certificate. However, a standard user will likely not
        notice anything. Therefore inspection of certificates is not a strong countermeasure.</p>

        <p>Preventive countermeasures are much more powerful. We now describe the preventive
        countermeasures that CAs and browser vendors can take, but users cannot.</p>

        <p><b>Certification Authorities</b> are recommended to stop using MD5 altogether.
        To prevent chosen prefix attacks, they can add a sufficient
        amount of randomness to the certificate fields, preferably as far to the start
        of the certificate as possible. The serial number is a good field to use for this,
        as it comes very close to the beginning of the certificate, and it allows for
        20 bytes of randomness. Many Certification Authorities seem to use already
        random serial numbers, albeit probably for different reasons. The German
        Signature Law prescribes random serial numbers for qualified SHA-1 certificates
        (see <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[B]</a>) to provide some randomness in the hash input.
        We do note however that this use of randomness in the serial number is a
        workaround, made possible by lucky choices in the X.509 standard. It is
        not a bad idea in general to add randomness to a hash input when a possible
        attacker is able to choose the input. A much more reliable, since designed,
        solution is to use randomized hashing, see <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[HK]</a> for a paper,
        and <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[BS]</a> for an implementation in Firefox. Such a solution
        introduces ramdomization as a "mode of operation" for hash functions,
        which is a much more fundamental approach to the problem than relying on
        features that happen to be present in existing standards for non-security reasons,
        or for no reason at all.</p>

        <p><img src="./MD5 considered harmful today_files/certificate5.png" style="float: right; margin: 10px 5px;">
        Other measures a Certification Authority may take are to make active use of
        the "pathlength" parameter in the "basic constraints" field.
        When a CA has the policy of only issuing end user certificates, this policy
        can be enforced technically by setting the path length to 0.
        Our specific attack scenario can be detected because there is
        a three-level hierarchy (see the upper picture).
        This detection can however be avoided by a small variant of our attack scenario,
        where the rogue colliding certificate is not a CA certificate
        but a website certificate in itself (see the lower picture). We note that such a rogue colliding
        end user certificate may be constructed without a tumor: the collision block can then
        be hidden again inside the public key. This makes detection much more difficult.
        Other ways of formatting the certificate may be possible.</p>

        <p>An interesting question is whether CAs should revoke existing certificates signed
        using MD5. One may argue that the present attack scenario has in principle been
        possible since May 2007, and that therefore all certificates (or all CA certificates)
        signed with MD5 that have been issued after this date may have been compromised.
        Whether they really have been compromised is not relevant. What is relevant is
        that the relying party who needs to trust the certificate does not have a proper
        way of checking whether the certificate is to be trusted or not. One may even
        argue that all older certificates based on MD5 should be revoked, as for an
        attacker constructing rogue certificates it is easy to backdate them to any
        date in the past he likes, so any MD5-based certificate may be a forgery.
        On the other hand, one may argue that the likelihood of these scenarios is
        quite small, and that the cost of replacing many MD5-based certificates may
        be substantial, so that therefore the risks of continued use of existing MD5-based
        certificates may be seen as acceptable. Regardless, MD5 should no longer
        be used for new certificates.</p>

        <p>Finally, Certification Authorities can monitor the flow of Certificate
        Signing Requests that they receive for abnormal series of requests, such as many
        requests by the same user in quick succession.</p>

        <p><b>Browser and Operating System vendors</b> such as Microsoft (vendor of Windows
        and Internet Explorer) and Mozilla (vendor of Firefox) can implement pop-up warnings
        to the users when an MD5-based certificate is encountered. Blocking MD5-based
        certificates is also possible, but rather drastic. Browser vendors can implement
        path length checking.
        Furthermore, it is the browser vendors who determine which Certification
        Authorities are present in the trust lists inside the browsers or operating systems.
        This puts them in a good position to put pressure on the Certification Authorities
        to adopt proper procedures and use strong cryptographic primitives.
        We have contacted the mentioned browser vendors so that they are aware of the problem.</p>

        <p><b>Website owners</b> can check whether their Certification Authority has proper
        procedures, notably does not use unacceptable hash functions such as MD5. Website owners
        can ask their CAs to switch to more secure hash functions such as SHA-2.</p>
    </td></tr>
<tr><td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right">
        <a name="sec71">7.1. Responses after publication</a>
    </td><td><td width="800">
        <p>[added Dec. 31, 2008] <b>Verisign</b>, the owner of the RapidSSL brand, has immediately responded when our work became
        public. See the announcement
        <a href="https://blogs.verisign.com/ssl-blog/2008/12/on_md5_vulnerabilities_and_mit.php" target="_blank">"This morning's
        MD5 attack - resolved"</a> by Tim Callan. Some interesting quotes from this blog:
        </p><ul>
        <li>"We applaud security research of this sort and are glad that white hats like the "MD5 Collision Inc."
        group make a point of investigating online security."
        </li><li>"We have discontinued using
        MD5 when we issue RapidSSL certificates, and we've confirmed that all other SSL Certificates
        we sell are not vulnerable to this attack. We'll continue on our path to discontinue MD5 in
        all end entity certificates by the end of January, 2009."
        </li><li>"... any customer who
        would like to do so can replace any MD5-hashed certificate free of charge."
        </li></ul>
        We are happy with this very quick and adequate response.<br>
        [added Jan. 6, 2009] See also a
        <a href="https://press.verisign.com/easyir/customrel.do?easyirid=AFC0FF0DB5C560D3&version=live&prid=463259&releasejsp=custom_97" target="_blank">Verisign press release</a> and a
        <a href="https://knowledge.rapidssl.com/support/ssl-certificate-support/index?page=content&id=AD125" target="_blank">RapidSSL
        Advisory</a>.<p></p>

        <p>[added Dec. 31, 2008] <b>Microsoft</b> issued a
        <a href="http://www.microsoft.com/technet/security/advisory/961509.mspx" target="_blank">Security
        Advisory (961509): "Research proves feasibility of collision attacks against MD5"</a>, and a
        Microsoft Technet blog item
        <a href="http://blogs.technet.com/swi/archive/2008/12/30/information-regarding-md5-collisions-problem.aspx" target="_blank">Information regarding MD5 collisions problem</a> by Damian Hasse.</p>

        <p>[added Dec. 31, 2008] <b>Mozilla</b> has a short item in the "Mozilla Security Blog":
        <a href="http://blog.mozilla.com/security/2008/12/30/md5-weaknesses-could-lead-to-certificate-forgery/" target="_blank">"MD5 Weaknesses Could Lead to Certificate Forgery"</a> by Johnathan Nightingale.</p>

        <p>[added Jan. 2, 2009] <b>TC TrustCenter</b> published a
        <a href="http://www.trustcenter.de/media/TC_response_to_MD5_vulnerability_paper.pdf" target="_blank">response (in English)</a> as well as a
        <a href="http://www.trustcenter.de/media/Stellungnahme_der_TC_TrustCenter_GmbH_zum_Artikel_von-5.pdf" target="_blank">Stellungnahme (auf Deutsch)</a>. Our attack does not apply to them because they
        ceased using automated online certification request processing, and because they use random
        serial numbers. They say they have started to replace MD5-based certificates.</p>

        <p>[added Jan. 2, 2009] <b>RSA</b> has an entry in the "Speaking of Security blog":
        <a href="http://www.rsa.com/blog/blog_entry.aspx?id=1411" target="_blank">"A Real New Year's Hash"</a> by Sam Curry.</p>

        <p>[added Jan. 2, 2009] <b>US-CERT</b>, the US Department of Homeland Security's Computer Emergency Readiness Team,
        published <a href="http://www.kb.cert.org/vuls/id/836068" target="_blank">Vulnerability Note VU#836068:
        "MD5 vulnerable to collision attacks"</a>. Interesting quotes from this note:
        </p><ul>
        <li>"<b>Do not use the MD5 algorithm</b>"<br>
            "Software developers, Certification Authorities, website owners, and users should avoid using the
            MD5 algorithm in any capacity. As previous research has demonstrated, it should be considered
            cryptographically broken and unsuitable for further use."
        </li><li>"<b>Scrutinize SSL certificates signed by certificates using the MD5 algorithm</b>"<br>
            "Users may wish to manually analyze the properties of web site certificates (...)
            Certificates listed as md5RSA or similar are affected.
            Such certificates that include strange or suspicious fields or other anomalies may be fraudulent.
            Because there are no reliable signs of tampering it must be noted that this workaround is
            error-prone and impractical for most users."
        </li></ul><p></p>

        <p>[added Jan. 15, 2009] <b>Cisco</b> published a
        <a href="http://www.cisco.com/en/US/products/products_security_response09186a0080a5d24a.html" target="_blank">"Cisco Security Response: MD5 Hashes May Allow for Certificate Spoofing "</a> because
        they think some of their products may be vulnerable as well.</p>
    </td></tr>
<tr><td><hr></td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right"><b>
        <a name="sec8">8. Frequently asked questions</a>
    </b></td><td><td width="800">
        <p><b>Question.</b>
        Can your proof of concept rogue CA certificate be misused?<br>
        <b>Answer.</b>
        This is highly unlikely. We intentionally set the expiration date of our rogue CA certificate
        to August 2004. Any certificate signed by our rogue CA will similarly be invalid after August 2004.
        This allows us to test our proof of concept certificate by setting the system date back to August 2004,
        but prevents the certificate from being misused if it ever falls into the wrong hands.
        If your system date is correct, your web browser will notify you that the certificate is invalid
        because it has expired, effectively warning you that that website should not be trusted.
        The validity period of the certificate is sufficiently short to make it most unlikely
        that the system clock of your computer is accidentally set back to this time.</p>

        <p><b>Question.</b>
        Are all digital certificates/signatures broken? <br>
        <b>Answer.</b>
        No. When digital certificates and signatures are based on secure cryptographic
        hash functions, our work yields no reason to doubt their security. Our result
        only applies when digital certificates are signed using the hash function MD5,
        which is known to be broken. With our method it is only possible to copy digital
        signatures based on MD5 between two specially constructed digital certificates.
        It is not possible to copy digital signatures based on MD5 from digital certificates
        unless the certificates are specially constructed. Even so, our result shows that
        MD5 is NOT suited for digital signatures. Certification Authorities should stop
        using the known broken MD5 and move to the widely available, more secure alternatives, such as SHA-2.</p>

        <p><b>Question.</b>
        What is the status of collision attacks for SHA-1?<br>
        <b>Answer.</b>
        As far as we know the only group seriously working on collision attacks for
        SHA-1 is in Graz, Austria, see their website
        <a href="http://www.iaik.tugraz.at/content/research/krypto/sha1/" target="_blank">"SHA-1 Collision Search"</a>.<br>
        Status of the theory: at the Rump Session of Crypto 2007 they estimated the
        complexity of their attack for collisions with identical initial <code>IHV</code>s to be
        <code>&lt;2<sup>61</sup></code> calls to the compression function. For chosen-prefix collisions they
        estimated in 2006 a complexity of just below the birthday bound of <code>2<sup>80</sup></code>.
        Improvements on the latter result are probably possible, but nobody has
        looked into this.<br>
        Status of experiments: Since mid 2007 the people in Graz are running a distributed
        <a href="http://boinc.iaik.tugraz.at/" target="_blank">SHA-1 Collision Search BOINC project</a>,
        aiming at finding a SHA-1 collision with identical initial <code>IHV</code>s. They
        estimate (private communication) that now (December 2008, so after 1.5 years) they have covered less
        that 10% of the search space. So they need your spare cycles.</p>

        <p><b>Question.</b>
        Suppose that a criminal creates by our method his own rogue Certification Authority that is trusted
        by all browsers.<br>
        Are then only websites with certificates from the CA whose signature he used vulnerable to impersonation attacks?<br>
        Are only websites with certificates based on MD5 vulnerable to impersonation attacks?<br>
        <b>Answer.</b>
        No. When a criminal uses redirection attacks in combination with a rogue but trusted CA certificate,
        all websites are equally vulnerable.</p>

        <p><b>Question.</b>
        What should websites do that have digital certificates signed with MD5?<br>
        <b>Answer.</b>
        Nothing at this point. Digital certificates legitimately obtained from all CAs can be believed to be secure and trusted, even if
        they were signed with MD5. Our method required the purchase of a specially crafted digital certificate from a
        CA and does not affect certificates issued to any other regular website.</p>

        <p><b>Question.</b>
        Where does the title "MD5 considered harmful today" of this website come from?<br>
        <b>Answer.</b>
        In December 2004, shortly after MD5 collisions were found, Dan Kaminsky came with
        an exploit for them. His paper is entitled "MD5 to be considered harmful someday", see
        <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[K1]</a>. We think this day has come.</p>

        <p><b>Question.</b>
        When and where will the paper with details on the chosen-prefix collision construction method be published?<br>
        <b>Answer.</b>
        A paper <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[SSALMOW]</a> on the improvements
        on the MD5 chosen-prefix collision construction method
        is available as of March 11, 2009.
        This paper will appear in the proceedings of <a href="http://www.iacr.org/conferences/crypto2009/" target="_blank">Crypto 2009</a>. <br>
        A full paper <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[SLW2]</a> on the MD5 chosen-prefix collision construction method is
        available as of June 16, 2009.</p>

        <p><b>Question.</b>
        Will source and/or executable code of the chosen-prefix collision construction method be made public?<br>
        <b>Answer.</b>
        For the time being we have no such plans.
        <br><br>
        [added June 16, 2009] But plans change, because the world changes. Almost half a year since the major
        CAs have moved away from MD5, we think it's safe to publish code. See Marc Stevens' code page
        <a href="http://code.google.com/p/hashclash/" target="_blank">hashclash -
        Framework for MD5 Differential Path Construction and Chosen-Prefix Collisions</a>.</p>

        <p><b>Question.</b>
        How do we know that the CAs still using MD5 havent already been attacked by somebody else?<br>
        <b>Answer.</b>
        Given the time and resources we needed to construct our proof of concept and the advanced mathematics required to
        implement our method, it is our opinion that it is unlikely this has happened already.
        However, because our proof of concept shows that it is possible, there is no 100% guarantee.</p>

        <p><b>Question.</b>
        What are the known weaknesses in DNS that you refer to in the press release?<br>
        <b>Answer.</b>
        The DNS spoofing vulnerability discovered by Dan Kaminsky in 2008 allows an attacker to redirect
        requests for any website to a web server controlled by them. For more information, please see
        <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[K2]</a> and <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[OMM]</a>.
        The SSL protocol used for secure websites is supposed to detect this kind of attack because
        the attacker would not have a legitimate digital certificate for the hijacked website.
        However, the MD5 collision attack we discovered allows attackers to create arbitrary trusted
        digital certificates and allows them to hijack any secure website on the Internet if the users
        DNS servers are not patched against the DNS spoofing vulnerability.</p>

        <p><b>Question.</b>
        How much did your proof of concept research cost?<br>
        <b>Answer.</b>
        It took a few months to design and implement our method, based on a lot of knowledge and skills that
        we have developed over the last two years. We spent about USD 700 on purchasing test certificates from a CA.
        The computations needed for our work were done on a cluster of about 200 PlayStation 3 game consoles
        in the cryptanalytic lab at EPFL.</p>

        <p><b>Question.</b>
        Why were game consoles used? What other hardware is suitable?<br>
        <b>Answer.</b>
        Game consoles use hardware specialized for the computational needs of the detailed 3D graphics in games.
        This hardware is also very suited for the basic arithmetic used in cryptographic algorithms and
        greatly outperforms general purpose computers on brute-force computations. We have found that one PlayStation 3
        game console is equivalent to about 40 modern single core processors. The most computationally
        intensive part of our method required about 3 days of work with over 200 game consoles, which is
        equivalent to 32 years of computing on a typical desktop computer. Common graphic cards
        have been used by <a href="http://www.elcomsoft.com/edpr.html" target="_blank">some</a> for MD5 cryptanalysis as well.</p>

        <p><b>Question.</b>
        How long would it take for someone else to try and imitate you?<br>
        <b>Answer.</b>
        The basic theory behind our work was published in 2007, but we have made a lot of improvements that
        are not yet in the literature. We estimate that a team of highly skilled researchers and programmers who have prior
        experience in this area would need at least a month to duplicate our work. Starting from scratch
        without prior understanding of the MD5 collision techniques would be far more challenging and would
        take significantly longer. In addition to cryptographic research and development expertise, access to significant
        computational resources is needed. Regardless of how long it would take to reproduce our work,
        MD5 should no longer be used for certificates. <br><br>
        [added June 16, 2009] Since we have now released full details and code, the answer above is of
        historic interest only.</p>

        <p><b>Question.</b>
        What is the best way to ensure that the attack scenario we developed is not possible in the future?<br>
        <b>Answer.</b>
        Stop using MD5 as soon as possible, and migrate to (more) secure cryptographic hash functions.</p>
    </td></tr>
<tr><td><hr></td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right"><b>
        Authors
    </b></td><td><td width="800">
        <img src="./MD5 considered harmful today_files/team.png"><br>
        left to right: Benne, Arjen, Marc, Jake, David, Alex (missing: Dag Arne)<br>
        (photo: Alexander Klink)
    </td></tr>
<tr><td><td>&nbsp;</td><td></tr>
<tr valign="top"><td width="200" align="right"><b>
    </b></td><td><td width="800">
        <b>Alexander Sotirov</b><br>
            Independent security researcher,<br>
            New York, USA<br>
            <a href="http://www.phreedom.org/" target="_blank">http://www.phreedom.org/</a>
    </td></tr>
<tr><td><td>&nbsp;</td><td></tr>
<tr valign="top"><td width="200" align="right"><b>
        <img src="./MD5 considered harmful today_files/cwi_logo.jpg" width="80">
    </b></td><td><td width="800">
        <b>Marc Stevens</b><br>
            Centrum Wiskunde &amp; Informatica (CWI),<br>
            Amsterdam, The Netherlands<br>
            <a href="http://homepages.cwi.nl/~stevens/" target="_blank">http://homepages.cwi.nl/~stevens/</a><br>
            News at the CWI website: <a href="http://www.cwi.nl/nl/node/839" target="_blank">English</a>,
        <a href="http://www.cwi.nl/en/node/838" target="_blank">Nederlands</a>.
    </td></tr>
<tr><td><td>&nbsp;</td><td></tr>
<tr valign="top"><td width="200" align="right"><b>
        <img src="./MD5 considered harmful today_files/noise-logo.gif" width="70"><br><img src="./MD5 considered harmful today_files/tor-logo.png" width="80">
    </b></td><td><td width="800">
        <b>Jacob Appelbaum</b><br>
            Noisebridge, The Tor Project,<br>
            San Francisco, USA<br>
            <a href="http://www.appelbaum.net/" target="_blank">http://www.appelbaum.net/</a>
    </td></tr>
<tr><td><td>&nbsp;</td><td></tr>
<tr valign="top"><td width="200" align="right"><b>
        <img src="./MD5 considered harmful today_files/epfl-logo.gif" width="100">
    </b></td><td><td width="800">
        <b>Arjen Lenstra</b><br>
            LACAL - LAboratory for Cryptologic ALgorithms,<br>
            EPFL - École Polytechnique Fédérale de Lausanne,<br>
            Lausanne, Switzerland<br>
            <a href="http://people.epfl.ch/arjen.lenstra" target="_blank">http://people.epfl.ch/arjen.lenstra</a>
    </td></tr>
<tr><td><td>&nbsp;</td><td></tr>
<tr valign="top"><td width="200" align="right"><b>
        <img src="./MD5 considered harmful today_files/eecs-logo.gif" width="100">
    </b></td><td><td width="800">
        <b>David Molnar</b><br>
            Computer Science Division,<br>
            University of California at Berkeley,<br>
            Berkeley, USA<br>
            <a href="http://www.cs.berkeley.edu/~dmolnar/" target="_blank">http://www.cs.berkeley.edu/~dmolnar/</a>
    </td></tr>
<tr><td><td>&nbsp;</td><td></tr>
<tr valign="top"><td width="200" align="right"><b>
        <img src="./MD5 considered harmful today_files/epfl-logo.gif" width="100">
    </b></td><td><td width="800">
        <b>Dag Arne Osvik</b><br>
            LACAL - LAboratory for Cryptologic ALgorithms,<br>
            EPFL - École Polytechnique Fédérale de Lausanne<br>
            Lausanne, Switzerland<br>
            <a href="http://people.epfl.ch/dagarne.osvik" target="_blank">http://people.epfl.ch/dagarne.osvik</a>
    </td></tr>
<tr><td><td>&nbsp;</td><td></tr>
<tr valign="top"><td width="200" align="right"><b>
        <img src="./MD5 considered harmful today_files/eipsi-logo.jpg" width="70"><br><img src="./MD5 considered harmful today_files/tue-logo.gif" width="80">
    </b></td><td><td width="800">
        <b>Benne de Weger</b><br>
            EiPSI - Eindhoven Institute for the Protection of Systems and Information,<br>
            TU/e - Eindhoven University of Technology,<br>
            Eindhoven, The Netherlands<br>
            <a href="http://www.win.tue.nl/~bdeweger/" target="_blank">http://www.win.tue.nl/~bdeweger/</a>
    </td></tr>
<tr><td><hr></td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right"><b>
        <a name="secInf">Information</a>
    </b></td><td><td width="800">
        <p>For press and general inquiries, please email
        <a href="mailto:md5-collisions@phreedom.org">md5-collisions@phreedom.org</a>.</p>

        <p></p>

        <p>There is a <a href="http://www.youtube.com/watch?v=Sx5-e5w9ais" target="_blank">video of Marc</a> explaining the work
        (in Dutch):</p>

        <object width="425" height="344"><param name="movie" value="http://www.youtube.com/v/Sx5-e5w9ais&amp;hl=en&amp;fs=1"><param name="allowFullScreen" value="true"><param name="allowscriptaccess" value="always"><embed src="http://www.youtube.com/v/Sx5-e5w9ais&amp;hl=en&amp;fs=1" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="425" height="344"></object>

        <p>For more information about this project, see the following project websites:
        </p><ul>
        <li><a href="./MD5 considered harmful today_files/MD5 considered harmful today.htm">http://www.win.tue.nl/hashclash/rogue-ca/</a> (this site)
        </li><li><a href="http://www.phreedom.org/research/rogue-ca/" target="_blank">http://www.phreedom.org/research/rogue-ca/</a> (Alex's site)
        </li><li><a href="https://i.broke.the.internet.and.all.i.got.was.this.t-shirt.phreedom.org/" target="_blank">
        https://i.broke.the.internet.and.all.i.got.was.this.t-shirt.phreedom.org/</a> (demo site,
        works only if you set your computer's system clock to August 2004)<!--<br>
        <a href="http://www.appelbaum.net/research/rogue-ca/" target="_blank">http://www.appelbaum.net/research/rogue-ca/</a>-->
        </li></ul><p></p>

        <p>[added Jan. 8, 2009] <a href="http://events.ccc.de/congress/2008/wiki/Conference_Recordings" target="_blank">Video
        and audio files of the 25C3 presentation</a> in different formats are available from CCC. Look for files with names like
        "25c3-3023-en-making_the_theoretical_possible.xyz". Interestingly, as a means for verifying the integrity
        of the downloads they provide the, uhm, <i>MD5</i> hashes of the files.</p>

        <p>[added Mar. 11, 2009] Our paper <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[SSALMOW]</a>
        on the improvements to the MD5 chosen-prefix collision
        construction method is now <a href="http://eprint.iacr.org/2009/111" target="_blank">available</a>.

        </p><p>[added June 2, 2009] The paper <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[SSALMOW]</a> has been updated, the final version
        will appear in the Proceedings of <a href="http://www.iacr.org/conferences/crypto2009/" target="_blank">Crypto 2009</a>, and
        is also <a href="http://eprint.iacr.org/2009/111" target="_blank">available online</a>.
        This final version also contains details about a new
        development: we now have a <a href="http://www.win.tue.nl/hashclash/SingleBlock/" target="_blank">single
        block chosen-prefix collision</a>.

        </p><p>[added June 16, 2009] The "full paper" <a href="http://www.win.tue.nl/hashclash/rogue-ca/#Ref">[SLW2]</a>
        is now available, including all the material of the other papers and
        descriptions of all the applications we have developed. It has been submitted to the
		<a href="http://www.iacr.org/jofc/jofc.html">Journal of Cryptology</a>.

		</p><p>[added August 22, 2009] The <a href="http://deweger.xs4all.nl/papers/[41]StSoApLeMoOsdW-RogueCA-Crypto[2009].pdf" target="_blank">Crypto paper</a> and the
        <a href="http://www.win.tue.nl/~bdeweger/award.html" target="_blank">best paper award</a>.

    </p></td></tr>
<tr><td><hr></td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right"><b>
        <a name="Ref">Links</a>
    </b></td><td><td width="800">
        <ul>
        <li> The IAIK <a href="http://boinc.iaik.tugraz.at/" target="_blank">SHA-1 Collision Search BOINC project</a>,
             and their <a href="http://www.iaik.tugraz.at/content/research/krypto/sha1/" target="_blank">"SHA-1
             Collision Search"</a> website.
        </li><li> <a href="http://th.informatik.uni-mannheim.de/People/lucks/HashCollisions/" target="_blank">"The story of Alice and her Boss"</a>, Magnus Daum and Stephan Lucks, 2005.
        </li><li> Peter Gutmann's  <a href="http://www.cs.auckland.ac.nz/~pgut001/dumpasn1.c" target="_blank">dumpasn1 program</a>,
             there's a <a href="http://geminisecurity.com/features-downloads/tools/guidumpasn" target="_blank">Windows GUI version</a>
             and an <a href="http://geminisecurity.com/parse.php" target="_blank">online version</a> as well.
             Peter Gutmann's <a href="http://www.cs.auckland.ac.nz/~pgut001/pubs/x509guide.txt" target="_blank">X.509 Style Guide</a>,
             and a <a href="http://www.cs.auckland.ac.nz/~pgut001/pubs/dave.der">certificate with an MPEG movie inside</a>.
        </li><li> The <a href="http://www.win.tue.nl/~bdeweger/CollidingCertificates/" target="_blank">"Colliding X.509
             Certificates based on MD5-collisions"</a> website, Arjen Lenstra, Benne de Weger, Xiaoyun Wang, March 2005.
        </li><li> The <a href="http://www.win.tue.nl/hashclash/TargetCollidingCertificates/" target="_blank">"Colliding X.509
             Certificates for Different Identities"</a> website, Marc Stevens, Arjen Lenstra and Benne de Weger, October 2006.
        </li><li> The <a href="http://www.win.tue.nl/hashclash/ChosenPrefixCollisions/" target="_blank">"Chosen-prefix
             collisions"</a> website, Marc Stevens, Arjen Lenstra and Benne de Weger, February 2007.
        </li><li> <a href="http://www.win.tue.nl/hashclash/Nostradamus/" target="_blank">"Predicting the winner of the
             2008 US Presidential Elections using a Sony PlayStation 3"</a>, website, Marc Stevens, Arjen Lenstra and
             Benne de Weger, November 2007.
        </li><li> <a href="http://www.win.tue.nl/hashclash/SoftIntCodeSign/" target="_blank">"Vulnerability of software integrity and
             code signing applications to chosen-prefix collisions for MD5 "</a>, website, Marc Stevens, Arjen Lenstra and
             Benne de Weger, November 2007.
        </li><li> The new <a href="http://www.win.tue.nl/hashclash/SingleBlock/" target="_blank">single block chosen-prefix collision</a>.
        </li><li> Verisign's response:
             <a href="https://blogs.verisign.com/ssl-blog/2008/12/on_md5_vulnerabilities_and_mit.php" target="_blank">"This morning's MD5 attack - resolved"</a> by Tim Callan,
             a <a href="https://press.verisign.com/easyir/customrel.do?easyirid=AFC0FF0DB5C560D3&version=live&prid=463259&releasejsp=custom_97" target="_blank">Verisign press release</a> and a
             <a href="https://knowledge.rapidssl.com/support/ssl-certificate-support/index?page=content&id=AD125" target="_blank">RapidSSL
             Advisory</a>.
        </li><li> Microsoft's <a href="http://www.microsoft.com/technet/security/advisory/961509.mspx" target="_blank">Security
             Advisory (961509): "Research proves feasibility of collision attacks against MD5"</a>, and a
             Microsoft Technet blog item
             <a href="http://blogs.technet.com/swi/archive/2008/12/30/information-regarding-md5-collisions-problem.aspx" target="_blank">Information regarding MD5 collisions problem</a> by Damian Hasse.
        </li><li> <a href="http://blog.mozilla.com/security/2008/12/30/md5-weaknesses-could-lead-to-certificate-forgery/" target="_blank">Mozilla Security Blog</a> by Johnathan Nightingale.
        </li><li> <a href="http://www.trustcenter.de/media/TC_response_to_MD5_vulnerability_paper.pdf" target="_blank">TC TrustCenter's response (in English)</a> as well as their
             <a href="http://www.trustcenter.de/media/Stellungnahme_der_TC_TrustCenter_GmbH_zum_Artikel_von-5.pdf" target="_blank">Stellungnahme (auf Deutsch)</a>.
        </li><li> RSA blog entry: <a href="http://www.rsa.com/blog/blog_entry.aspx?id=1411" target="_blank">"A Real
             New Year's Hash"</a> by Sam Curry.
        </li><li> US-CERT <a href="http://www.kb.cert.org/vuls/id/836068" target="_blank">Vulnerability Note VU#836068:
             "MD5 vulnerable to collision attacks"</a>.
        </li><li> <a href="http://events.ccc.de/congress/2008/wiki/Conference_Recordings" target="_blank">Video and audio files
             of the 25C3 presentation</a> are available from CCC.
		</li><li> <a href="http://www.cisco.com/en/US/products/products_security_response09186a0080a5d24a.html" target="_blank">"Cisco Security Response: MD5 Hashes May Allow for Certificate Spoofing "</a>.
        </li></ul>
    </td></tr>
<tr><td><hr></td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right"><b>
        <a name="Ref">References</a>
    </b></td><td><td width="800">
        <table width="100%" cellpadding="5">
        <tbody><tr><td valign="top">[B]</td><td>
            Bundesnetzagentur für Elektrizität, Gas, Telekommunikation, Post und Eisenbahnen, <br>
            "Bekanntmachung zur elektronischen Signatur nach dem Signaturgesetz und der Signaturverordnung
            (Übersicht über geeignete Algorithmen)", <br>
            <a href="http://www.bundesnetzagentur.de/media/archive/14953.pdf" target="_blank">http://www.bundesnetzagentur.de/media/archive/14953.pdf</a>,<br>
            November 2008.
        </td></tr><tr><td valign="top">[BS]</td><td>
            Dan Boneh and Weidong Shao, <br>
            "Randomized Hashing for Digital Certificates: Halevi-Krawczyk Hash, An implementation in Firefox",<br>
            <a href="http://crypto.stanford.edu/firefox-rhash/" target="_blank">http://crypto.stanford.edu/firefox-rhash/</a>,<br>
            January, 2007.
        </td></tr><tr><td valign="top">[HK]</td><td>
            Shai Halevi and Hugo Krawczyk, <br>
            "Strengthening Digital Signatures via Randomized Hashing",<br>
            <a href="http://www.ee.technion.ac.il/~hugo/rhash/rhash.pdf" target="_blank">http://www.ee.technion.ac.il/~hugo/rhash/rhash.pdf</a>,<br>
            January, 2007.
        </td></tr><tr><td valign="top">[HPFS]</td><td>
            R. Housley, W. Polk, W. Ford, D. Solo, <br>
            "Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile",<br>
            IETF RFC 3280,<br>
            April 2002,<br>
            available from <a href="http://www.ietf.org/rfc/rfc3280.txt" target="_blank">http://www.ietf.org/rfc/rfc3280.txt</a>.
        </td></tr><tr><td valign="top">[K1]</td><td>
            Dan Kaminsky,<br>
            "MD5 to be considered harmful someday"<br>
            <a href="http://www.doxpara.com/md5_someday.pdf" target="_blank">http://www.doxpara.com/md5_someday.pdf</a>,<br>
            December 2004.
        </td></tr><tr><td valign="top">[K2]</td><td>
            Dan Kaminsky,<br>
            "Black Ops 2008: It's the end of the cache as we know it"<br>
            <a href="http://www.doxpara.com/DMK_BO2K8.ppt" target="_blank">http://www.doxpara.com/DMK_BO2K8.ppt</a>,<br>
            August 2008.
        </td></tr><tr><td valign="top">[LW]</td><td>
            Arjen Lenstra and Benne de Weger,<br>
            "On the possibility of constructing meaningful hash collisions for public
            keys",<br>
            In: Colin Boyd and Juan Manuel Gonzalez Nieto (editors),<br>
            "Information Security and Privacy - Proceedings of ACISP 2005",<br>
            volume 3574 of Lecture Notes in Computer Science, pages 267-279,<br>
            Springer Verlag, Berlin, 2005.
        </td></tr><tr><td valign="top">[OMM]</td><td>
            Matthew Olney, Patrick Mullen, Kevin Miklavcic,<br>
            "Dan Kaminskys 2008 DNS Vulnerability", <br>
            Snort Whitepaper, available at
            <a href="http://www.snort.org/vrt/docs/white_papers/DNS_Vulnerability.pdf" target="_blank">http://www.snort.org/vrt/docs/white_papers/DNS_Vulnerability.pdf</a>,<br>
            July 2008.
        </td></tr><tr><td valign="top">[S]</td><td>
            Marc Stevens,<br>
            "On collisions for MD5",<br>
            MSc Thesis, Eindhoven University of Technology,<br>
            June 2007,<br>
            available from <a href="http://www.win.tue.nl/hashclash/" target="_blank">http://www.win.tue.nl/hashclash/</a>.
        </td></tr><tr><td valign="top">[SLW]</td><td>
            Marc Stevens, Arjen Lenstra and Benne de Weger,<br>
            "Chosen-prefix Collisions for MD5 and Colliding X.509 Certificates for Different Identities",<br>
            In: Moni Naor (editor), "Advances in Cryptology - EUROCRYPT 2007",<br>
            volume 4515 of Lecture Notes in Computer Science, pages 1-22,<br>
            Springer Verlag, Berlin, 2007.
        </td></tr><tr><td valign="top">[SLW2]</td><td>
            Marc Stevens, Arjen Lenstra and Benne de Weger,<br>
            "Chosen-prefix Collisions for MD5 and Applications",<br>
            submitted to the Journal of Cryptology, available from
            <a href="https://documents.epfl.ch/users/l/le/lenstra/public/papers/lat.pdf" target="_blank">LACAL, EPFL</a>.
        </td></tr><tr><td valign="top">[SSALMOW]</td><td>
            Marc Stevens, Alexander Sotirov, Jacob Appelbaum, Arjen Lenstra, David Molnar,
            Dag Arne Osvik and Benne de Weger, <br>
            <a href="http://deweger.xs4all.nl/papers/[41]StSoApLeMoOsdW-RogueCA-Crypto[2009].pdf" target="_blank">"Short
            chosen-prefix collisions for MD5 and the creation of a rogue CA certificate"</a>,<br>
            in: Shai Halevi (ed.), "Advances in Cryptology - CRYPTO 2009", Proceedings of
            <a href="http://www.iacr.org/conferences/crypto2009/" target="_blank">Crypto 2009</a>,
            Springer LNCS 5677, 2009, pp. 55-69.
        </td></tr><tr><td valign="top">[WY]</td><td>
            Xiaoyun Wang and Hongbo Yu,<br>
            "How to Break MD5 and Other Hash Functions"<br>
            In: Ronald Cramer (editor), "Advances in Cryptology - EUROCRYPT 2005",<br>
            volume 3494 of Lecture Notes in Computer Science, pages 19-35,<br>
            Springer Verlag, Berlin, 2005.
        </td></tr></tbody></table>
    </td></tr>
<tr><td><hr></td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right"><b>
        Latest Modification
    </b></td><td><td width="800">
        January 13, 2010
    </td></tr>
<tr><td><hr></td><td>&nbsp;</td><td><hr></td></tr>
<tr valign="top"><td width="200" align="right"><b>Vanity Counter</b></td>
    <td><td width="800">
        <img src="./MD5 considered harmful today_files/Count.exe" align="absmiddle">
        <script language="JavaScript">
           <!--
           document.write("<img src=\"http://deweger.xs4all.nl/cgi-bin/logr.pl?ref="+top.document.referrer+"\" width=16 height=16 border=0>");
           //-->
        </script><img src="./MD5 considered harmful today_files/logr.pl" width="16" height="16" border="0">
        <noscript></noscript>
    </td></tr>
</tbody></table>



</body></html>